<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>UIAppearance</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="UIAppearance,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="UIAppearance,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"🌜"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>UIAppearance</span><span class=btRight><span title="Author · 作者" class=author>Mattt</span> <span title="Translator · 翻译" class=author>Chester Liu</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post · 关联或转载引用的文章" target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics · 回主题页">&#127793;</a></span></h1><p>美观还是实际？直接还是间接？感情还是理智？</p><p>美，究竟是肤浅的一个概念，还是深层事实的一种表层体现？当我们说一个东西具有好的设计的时候，我们到底在谈论什么？审美的标准是相对的还是绝对的？</p><p>这些深刻的问题，哲学家，艺术家和手工艺者们已经深思了近千年。</p><p>在我们继续追寻美的意义和对于宇宙更深的理解的同时，应用市场对于这个话题的反映倒很明确：</p><p><strong>用户愿意为好看的软件花大价钱。</strong></p><p>当一个人买了一台 iPhone 的时候，他同时也是“买”了苹果的哲学——所有好用的东西也应该是好看的。同样的道理也适用于开发领域，粗糙的界面会让人们感觉代码也不会好到哪里去。</p><p>在以前的 iOS 开发中，一些很细小的界面定制工作也需要用到一些会影响到 AppStore 审核的办法，例如 method swizzling。幸运的是，在 iOS 5 上，出现一种新的解决办法：<code>UIAppearance</code>。</p><hr><p><code>UIAppearance</code> 允许我们对视图和控件的样式在整个应用范围内进行统一的定义。</p><p>为了让这个机制融入已有的 UIKit 体系，苹果设计了一个很聪明的办法：<code>UIAppearance</code> 是一个协议，它返回一个 proxy，这个 proxy 会把所有的配置都转发给某个特定类的实例们。为什么使用 proxy 而不是在直接在 <code>UIView</code> 里添加一个属性或者方法呢？因为有一些不是 <code>UIView</code>
的对象也会渲染自己的组合视图，例如 <code>UIBarButtonItem</code>。<code>UIAppearance</code> 可以定制一个类所有的实例，也可以限定在具体的视图结构中（译者注：下面文档来自苹果官方文档，不再做翻译）：</p><blockquote><ul><li><code>+appearance</code>: Returns the appearance proxy for the receiver.</li><li><code>+appearanceWhenContainedIn:(Class &lt;UIAppearanceContainer>)ContainerClass,...</code>: Returns the appearance proxy for the receiver in a given containment hierarchy.</li></ul><p>To customize the appearance of all instances of a class, you use <code>appearance()</code> to get the appearance proxy for the class. For example, to modify the tint color for all instances of UINavigationBar:</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>UINavigationBar.appearance().tintColor = myColor
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[[UINavigationBar appearance] setTintColor:myColor];
</span></span></code></pre></div><blockquote><p>To customize the appearances for instances of a class when contained within an instance of a container class, or instances in a hierarchy, you use <code>appearanceWhenContainedInInstancesOfClasses(_:)</code> to get the appearance proxy for the class (the older, variadic <code>appearanceWhenContainedIn</code> method has been deprecated):</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>UIBarButtonItem.appearanceWhenContainedInInstancesOfClasses([UINavigationBar.<span style=color:#66d9ef>self</span>])
</span></span><span style=display:flex><span>				.tintColor = myNavBarColor
</span></span><span style=display:flex><span>UIBarButtonItem.appearanceWhenContainedInInstancesOfClasses([UINavigationBar.<span style=color:#66d9ef>self</span>, UIPopoverController.<span style=color:#66d9ef>self</span>])
</span></span><span style=display:flex><span>				.tintColor = myNavBarColor
</span></span><span style=display:flex><span>UIBarButtonItem.appearanceWhenContainedInInstancesOfClasses([UIToolbar.<span style=color:#66d9ef>self</span>])
</span></span><span style=display:flex><span>				.tintColor = myNavBarColor
</span></span><span style=display:flex><span>UIBarButtonItem.appearanceWhenContainedInInstancesOfClasses([UIToolbar.<span style=color:#66d9ef>self</span>, UIPopoverController.<span style=color:#66d9ef>self</span>])
</span></span><span style=display:flex><span>				.tintColor = myNavBarColor
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[[UIBarButtonItem appearanceWhenContainedInInstancesOfClasses:<span style=color:#ae81ff>@[</span>[UINavigationBar <span style=color:#66d9ef>class</span>]<span style=color:#ae81ff>]</span>]
</span></span><span style=display:flex><span>       setTintColor:myNavBarColor];
</span></span><span style=display:flex><span>[[UIBarButtonItem appearanceWhenContainedInInstancesOfClasses:<span style=color:#ae81ff>@[</span>[UINavigationBar <span style=color:#66d9ef>class</span>], [UIPopoverController <span style=color:#66d9ef>class</span>]<span style=color:#ae81ff>]</span>]
</span></span><span style=display:flex><span>        setTintColor:myPopoverNavBarColor];
</span></span><span style=display:flex><span>[[UIBarButtonItem appearanceWhenContainedInInstancesOfClasses:<span style=color:#ae81ff>@[</span>[UIToolbar <span style=color:#66d9ef>class</span>]<span style=color:#ae81ff>]</span>]
</span></span><span style=display:flex><span>        setTintColor:myToolbarColor];
</span></span><span style=display:flex><span>[[UIBarButtonItem appearanceWhenContainedInInstancesOfClasses:<span style=color:#ae81ff>@[</span>[UIToolbar <span style=color:#66d9ef>class</span>], [UIPopoverController <span style=color:#66d9ef>class</span>]<span style=color:#ae81ff>]</span>]
</span></span><span style=display:flex><span>        setTintColor:myPopoverToolbarColor];
</span></span></code></pre></div><h2 id=判断-uiappearance-可以应用于哪些属性>判断 <code>UIAppearance</code> 可以应用于哪些属性</h2><p><code>UIAppearance</code> 使用 proxy 的办法带来的一个主要问题是，很难知道 selector 是不是真正可以用的。</p><p><del>因为 <tt>+appearance</tt> 返回的是 <tt>id</tt>, Xcode 不能提供任何代码补全信息，这个造成困惑和问题的主要原因</del></p><p><ins>在 iOS 7 上, UIAppearance 现在返回的是 <a href=https://nshipster.cn/instancetype/><tt>instancetype</tt></a>，使得代码补全可以正常工作了。 万岁！</ins></p><p>要想知道哪些方法可以应用于 <code>UIAppearance</code>，你得<a href=http://stackoverflow.com/questions/9424112/what-properties-can-i-set-via-an-uiappearance-proxy>去头文件中找</a>：</p><pre tabindex=0><code>$ cd /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/
  Developer/SDKs/iPhoneOS*.sdk/System/Library/Frameworks/UIKit.framework/Headers
$ grep -H UI_APPEARANCE_SELECTOR ./* | sed &#39;s/ __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0) UI_APPEARANCE_SELECTOR;//&#39;
</code></pre><p><code>UIAppearance</code> 会在方法签名中查找 <code>UI_APPEARANCE_SELECTOR</code> 宏。任何有这个注解的方法都可以被 <code>appearance</code> proxy 使用。</p><p><a href=https://gist.github.com/mattt/5135521>这里是 iOS 7.0 上所有的属性列表</a>，方便你参考使用。</p><h2 id=在自定义的-uiview-子类中实现-uiappearance>在自定义的 UIView 子类中实现 <code>&lt;UIAppearance></code></h2><p>就像 <a href=https://nshipster.cn/nslocalizedstring/><code>NSLocalizedString</code></a> 和 <a href=https://nshipster.cn/pragma/><code>#pragma</code></a>是高质量的 Objective-C 代码的标志一样，让自定义的界面类支持 <code>UIAppearance</code>，不仅仅是一种最佳实践，同时也展示了开发者在代码实现上花费了一定程度的心血。</p><p><a href=https://twitter.com/steipete>Peter Steinberger</a> 撰写了 <a href=http://petersteinberger.com/blog/2013/uiappearance-for-custom-views/>这篇优秀的博文</a>，其中描述了在自定义视图中实现 <code>UIAppearance</code> 时需要注意的一些地方。对于在开源 UI 控件中追求极致实现的人来说，这篇文章是必读的。</p><h2 id=替代品>替代品</h2><p><code>UIAppearance</code> 另一个主要的不足之处在于，样式的规则是 <em>命令式</em> 的，而不是 <em>描述式</em> 的。也就是说，样式是在应用执行时在代码中进行应用，而不是从一个规则列表中获取。</p><p>是的，如果我们可以 Web 开发中偷过来一个主意的话，那一定就是内容和表现分离了。不管你对 CSS 有什么看法，样式表实在是 <em>美妙之极</em> 。</p><p>到目前为止，样式表的狂热爱好者在 iOS 上有几个可选的替代品。<a href=http://www.pixate.com>Pixate</a> 是一个商业框架，支持使用 CSS 来定制应用样式。<a href=https://github.com/tombenner/nui>NUI</a>，一个由 <a href=https://github.com/tombenner>Tom Benner</a> 发起的开源项目，使用类似 CSS/SCSS 的语言，做的差不多是同样的事情。和它同一战线的另一个开源项目是 <a href=https://github.com/robertwijas/UISS>UISS</a>，由 <a href=https://github.com/robertwijas>Robert Wijas</a> 发起，允许我们从 JSON 中读取 <code>UIAppearance</code> 规则。</p><hr><p>Cocoa 开发者痴迷于视觉审美的历史可以追溯到很久之前，他们经常会通过很极致的方法来实现想要的效果。回忆一下 Mac 开发者的 <a href=https://en.wikipedia.org/wiki/Delicious_Generation>美味时代</a>，以及诸如 <a href=http://discoapp.com>Disco</a> 这样的 App，它<a href="http://www.youtube.com/watch?v=8Dwi47XOqwI">在烧录光盘时会释放出虚拟的烟雾效果</a>。</p><p>这种决心让东西看起来好看的精神，在 iOS 平台上同样蔚然成风。作为社区和生态系统的一员，在用户对于应用的期望上，我们不懈地努力，去挑战极限。在这个过程中，我们的工作变得更加具有挑战性，也使得开发 iOS 的体验更加像是一种享受。</p><p>不要止步于金玉其外败絮其中（反之亦然）。让你的应用从界面到实现都变得优美。</p><hr><p>除非<a href=https://nshipster.cn/ target=_blank>另有声明</a>，本文采用知识共享「<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>署名-非商业性使用 3.0 中国大陆</a>」许可协议授权。</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top · 回顶部" rel=nofollow>&#127772;2013-03-11 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2025 Mattt 版权所有</a><a href=https://autoptr.top/ title="Back to Home · 回首页">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>标签:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>分类:</span><li><a class=link href=https://autoptr.top/categories/Cocoa target=_blank>Cocoa</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>