<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>Swift Literal Convertibles</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="Swift Literal Convertibles,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="Swift Literal Convertibles,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>Swift Literal Convertibles</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>Chester Liu</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>ä¸Šå‘¨æˆ‘ä»¬æ¢è®¨äº†å¦‚ä½•åœ¨ Swift ä¸­ <a href=https://nshipster.cn/swift-operators/>é‡è½½å’Œåˆ›å»ºè‡ªå®šä¹‰æ“ä½œç¬¦</a>ï¼Œè¿™ä¸ªè¯­è¨€ç‰¹æ€§ååˆ†å¼ºå¤§ï¼ŒåŒæ—¶ä¹Ÿé¢‡å…·äº‰è®®ã€‚</p><p>ä»å„æ–¹é¢æ¥çœ‹ï¼Œæœ¬å‘¨çš„æ–‡ç« ä¹Ÿæå°†ä¸¤æåˆ†åŒ–ï¼Œå› ä¸ºå®ƒçš„å†…å®¹æ˜¯ Swift å½“ä¸­ä¸€ä¸ªæ— å¤„ä¸åœ¨ï¼Œç„¶è€Œåˆä¸è¢«äººæ³¨æ„çš„ç‰¹æ€§ï¼šå­—é¢å€¼å¯è½¬æ¢æ€§ã€‚</p><hr><p>åœ¨ä»£ç å½“ä¸­ï¼Œä¸€ä¸ª <em>å­—é¢å€¼</em> æ˜¯ä¸€ä¸ªå›ºå®šå€¼çš„è¡¨ç¤ºã€‚ç»å¤§éƒ¨åˆ†è¯­è¨€éƒ½ä¸ºä¸€äº›åŸºæœ¬ç±»å‹å®šä¹‰äº†å­—é¢å€¼ï¼ŒåŒ…æ‹¬é€»è¾‘å€¼ï¼Œæ•°å­—ï¼Œå­—ç¬¦ä¸²ç­‰ï¼Œé€šå¸¸ä¹Ÿæœ‰æ•°ç»„å’Œå­—å…¸ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> int = <span style=color:#ae81ff>57</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> float = <span style=color:#ae81ff>6.02</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> string = <span style=color:#e6db74>&#34;Hello&#34;</span>
</span></span></code></pre></div><p>å­—é¢å€¼å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œæ˜¯ç¼–ç¨‹æ—¶å·²ç»æ ¹æ·±è’‚å›ºçš„ä¸€ä¸ªæ¦‚å¿µï¼Œä»¥è‡³äºæˆ‘ä»¬å½“ä¸­çš„å¤§å¤šæ•°äººä¸ä¼šå»ä¸»åŠ¨æ€è€ƒç¼–è¯‘å™¨çœŸæ­£åšäº†äº›ä»€ä¹ˆï¼ˆå› æ­¤ä¹Ÿå¹¶ä¸äº†è§£ç±»ä¼¼ <a href=https://en.wikipedia.org/wiki/String_interning>å­—ç¬¦ä¸²é©»ç•™</a> ç­‰å·§å¦™çš„æŠ€å·§ï¼Œä¸€ç§å¹¸ç¦çš„æ— çŸ¥ï¼‰ã€‚</p><p>ç®€å•äº†è§£ä¸€ä¸‹è¿™äº›æœ€åŸºç¡€çš„å†…å®¹ï¼Œæœ‰åŠ©äºè®©ä»£ç å˜å¾—æ›´åŠ å¥½è¯»å¥½å†™ã€‚</p><p>åœ¨ Swift ä¸­ï¼Œé€šè¿‡ <em>å­—é¢å€¼å¯è½¬æ¢åè®®ï¼ˆliteral convertible protocolsï¼‰</em> ï¼Œå¼€å‘è€…å¯ä»¥æ§åˆ¶é€šè¿‡å­—é¢å€¼åˆ›å»ºå€¼çš„è¿‡ç¨‹ã€‚</p><p>æ ‡å‡†åº“å®šä¹‰äº† 10 ä¸ªè¿™ç§åè®®ï¼š</p><ul><li><code>ArrayLiteralConvertible</code></li><li><code>BooleanLiteralConvertible</code></li><li><code>DictionaryLiteralConvertible</code></li><li><code>ExtendedGraphemeClusterLiteralConvertible</code></li><li><code>FloatLiteralConvertible</code></li><li><code>NilLiteralConvertible</code></li><li><code>IntegerLiteralConvertible</code></li><li><code>StringLiteralConvertible</code></li><li><code>StringInterpolationConvertible</code></li><li><code>UnicodeScalarLiteralConvertible</code></li></ul><p>ä»»æ„éµå¾ªäº†ä¸Šé¢æŸä¸ªåè®®çš„ <code>class</code> æˆ– <code>struct</code> éƒ½å¯ä»¥é€šè¿‡å¯¹åº”çš„å­—é¢å€¼æ¥é™æ€åˆå§‹åŒ–ä¸€ä¸ªè‡ªå·±çš„å®ä¾‹ã€‚</p><p>è¿™ä¸ªç‰¹æ€§ä½¿å¾—å­—é¢å€¼åœ¨æ•´ä¸ªè¯­è¨€ä¸­éƒ½èƒ½å¤Ÿç©å¾—è½¬ã€‚</p><p>ä»¥ optionals åšä¸ºä¾‹å­ã€‚</p><h2 id=nilliteralconvertible-å’Œ-optionals>NilLiteralConvertible å’Œ Optionals</h2><p>æœ‰å…³ Swift çš„ optionals æœ€å¥½çš„ä¸€ç‚¹å°±æ˜¯ï¼Œå®ƒçš„åº•å±‚æœºåˆ¶å®é™…ä¸Šæ˜¯ä½¿ç”¨è¯­è¨€è‡ªèº«å®šä¹‰çš„ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Optional</span>&lt;T&gt; : Reflectable, NilLiteralConvertible {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> None
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> Some(T)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(<span style=color:#66d9ef>_</span> some: T)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(nilLiteral: ())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>map</span>&lt;U&gt;(f: (T) -&gt; U) -&gt; U?
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>getMirror</span>() -&gt; MirrorType
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ³¨æ„ <code>Optional</code> éµå¾ªäº† <code>NilLiteralConvertible</code> æ¥å£ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>NilLiteralConvertible</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(nilLiteral: ())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è€ƒè™‘ä¸‹é¢ä¸¤ä¸ªè¯­å¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> a: AnyObject = <span style=color:#66d9ef>nil</span> <span style=color:#75715e>// !</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> b: AnyObject? = <span style=color:#66d9ef>nil</span>
</span></span></code></pre></div><p><code>var a</code> çš„å£°æ˜ä¼šå¯¼è‡´ç¼–è¯‘å™¨æŠ¥è­¦ <code>Type 'AnyObject' does not conform to the protocol 'NilLiteralConvertible</code>ï¼Œè€Œ <code>var b</code> çš„å£°æ˜å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p>ä»åº•å±‚çœ‹æ¥ï¼Œå½“ä¸€ä¸ªå­—é¢å€¼è¢«èµ‹å€¼çš„æ—¶å€™ï¼ŒSwift ç¼–è¯‘å™¨æŸ¥è¯¢å¯¹åº”çš„ <code>protocol</code>ï¼ˆåœ¨è¿™é‡Œæ˜¯ <code>NilLiteralConvertible</code>ï¼‰ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„åˆå§‹åŒ–å™¨ï¼ˆ<code>init(nilLiteral: ())</code>ï¼‰ã€‚</p><p>å°½ç®¡ <code>init(nilLiteral: ())</code> çš„å®ç°æ²¡æœ‰å…¬å¼€ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯ï¼Œè¢«è®¾ç½®ä¸º <code>nil</code> çš„ <code>Optional</code> å˜æˆäº† <code>.None</code>ã€‚</p><h2 id=stringliteralconvertible-å’Œæ­£åˆ™è¡¨è¾¾å¼>StringLiteralConvertible å’Œæ­£åˆ™è¡¨è¾¾å¼</h2><p>Swift å­—é¢å€¼å¯è½¬æ¢æ€§å¯ä»¥ç”¨æ¥ä¸ºè‡ªå®šä¹‰å¯¹è±¡æä¾›æ–¹ä¾¿çš„å¿«é€Ÿåˆå§‹åŒ–æ–¹æ³•ã€‚</p><p>å›å¿†ä¸€ä¸‹æˆ‘ä»¬ä¸Šå‘¨çš„ <a href=https://nshipster.cn/swift-operators/><code>Regex</code></a> ä¾‹å­ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Regex</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> pattern: String
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> options: NSRegularExpressionOptions!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> matcher: NSRegularExpression {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> NSRegularExpression(pattern: <span style=color:#66d9ef>self</span>.pattern, options: <span style=color:#66d9ef>self</span>.options, error: <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(pattern: String, options: NSRegularExpressionOptions = <span style=color:#66d9ef>nil</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.pattern = pattern
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.options = options
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>match</span>(string: String, options: NSMatchingOptions = <span style=color:#66d9ef>nil</span>) -&gt; Bool {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>.matcher.numberOfMatchesInString(string, options: options, range: NSMakeRange(<span style=color:#ae81ff>0</span>, string.utf16Count)) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æœ‰ Ruby å’Œ Perl èƒŒæ™¯çš„ç¨‹åºå‘˜å¯èƒ½ä¼šå¯¹ Swift ç¼ºå°‘æ­£åˆ™è¡¨è¾¾å¼å­—é¢å€¼æ„Ÿåˆ°å¤±æœ›ï¼Œè¿™ä¸ªç¼ºæ†¾å¯ä»¥ä½¿ç”¨ <code>StringLiteralConvertible</code> åè®®æ¥å¼¥è¡¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Regex</span>: StringLiteralConvertible {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>typealias</span> ExtendedGraphemeClusterLiteralType = StringLiteralType
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(unicodeScalarLiteral value: UnicodeScalarLiteralType) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.pattern = <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>\(</span>value<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(extendedGraphemeClusterLiteral value: ExtendedGraphemeClusterLiteralType) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.pattern = value
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(stringLiteral value: StringLiteralType) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.pattern = value
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p><code>StringLiteralConvertible</code> è‡ªèº«ç»§æ‰¿è‡ª <code>ExtendedGraphemeClusterLiteralConvertible</code> åè®®ï¼Œè¿™ä¸ªåè®®åˆç»§æ‰¿è‡ª <code>UnicodeScalarLiteralConvertible</code>ã€‚<code>ExtendedGraphemeClusterLiteralType</code> æ˜¯è¡¨ç¤ºé•¿åº¦ä¸º 1 çš„ <code>String</code> çš„å†…éƒ¨ç±»å‹ï¼Œ<code>UnicodeScalarLiteralType</code> æ˜¯è¡¨ç¤ºä¸€ä¸ª <code>Character</code> çš„æ•°æ®ç±»å‹ã€‚ä¸ºäº†å®ç°å¿…è¦çš„ <code>init</code> æ–¹æ³•ï¼Œ<code>ExtendedGraphemeClusterLiteralType</code> å’Œ <code>UnicodeScalarLiteralType</code> å¯ä»¥åˆ†åˆ«ç”¨ <code>typealias</code> å®šä¹‰æˆåˆ«å <code>StringLiteralType</code> å’Œ <code>Character</code>ã€‚</p></blockquote><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> string: String = <span style=color:#e6db74>&#34;foo bar baz&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> regex: Regex = <span style=color:#e6db74>&#34;foo&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>regex.match(string) <span style=color:#75715e>// true</span>
</span></span></code></pre></div><p>&mldr;æˆ–è€…æ›´ç®€å•ä¸€äº›ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#e6db74>&#34;foo&#34;</span>.match(string) <span style=color:#75715e>// true</span>
</span></span></code></pre></div><p>å’Œ <a href=https://nshipster.cn/swift-operators>è‡ªå®šä¹‰è¿ç®—ç¬¦ <code>=~</code></a> ç»“åˆèµ·æ¥ï¼Œè¿˜å¯ä»¥å†™æˆæ›´åŠ ç¬¦åˆä¹ æƒ¯çš„è¯­æ³•ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#e6db74>&#34;foo bar baz&#34;</span> =<span style=color:#f92672>~</span> <span style=color:#e6db74>&#34;foo&#34;</span> <span style=color:#75715e>// true</span>
</span></span></code></pre></div><hr><p>æœ‰äº›äººå¯èƒ½ä¼šå¹æ¯ï¼Œè®¤ä¸ºè¿™ä¸ªç‰¹æ€§æ ‡å¿—ç€ä»£ç å¯è¯»æ€§å’Œå¯ç†è§£æ€§çš„ç»ˆç»“ï¼Œå¦å¤–ä¸€äº›äººå¯èƒ½åªæ˜¯è®¤ä¸ºå®ƒå¼¥è¡¥äº†è¿™é—¨æ–°è¯­è¨€å½“ä¸­ç¼ºå¤±çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸»è¦é—®é¢˜è¿˜æ˜¯åœ¨äºä½ ä¹‹å‰çš„ä¹ æƒ¯ï¼Œä»¥åŠä½ æ˜¯å¦è®¤åŒå¼€å‘è€…æœ‰èµ„æ ¼ä¸ºè¯­è¨€æ·»åŠ ç‰¹æ€§ï¼Œä»¥æ›´å¥½åœ°æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ã€‚</p><blockquote><p>ä¸ç®¡æ€æ ·ï¼Œæˆ‘å¸Œæœ›æˆ‘ä»¬éƒ½èƒ½è®¤åŒä¸€ç‚¹â€”â€”è¿™ä¸ªè¯­è¨€ç‰¹æ€§ <em>å¾ˆæœ‰è¶£</em> ï¼Œè€Œä¸”å€¼å¾—æ·±å…¥æŒ–æ˜ã€‚åœ¨è¿™æ ·çš„ç²¾ç¥ä¸‹ï¼Œæˆ‘ä»¬ç»§ç»­æ¢ç´¢çš„è·¯ç¨‹ï¼Œè¿›ä¸€æ­¥å±•ç¤ºæ›´å¤šçš„ç”¨ä¾‹ã€‚</p></blockquote><hr><h2 id=arrayliteralconvertible-å’Œ-sets>ArrayLiteralConvertible å’Œ Sets</h2><p>ä½œä¸ºä¸€ä¸ªå¯¹ä¸å¯å˜æ€§å’Œå®‰å…¨æ€§æœ‰ç€æ·±åˆ»è¦æ±‚çš„è¯­è¨€ï¼ŒSwift çš„æ ‡å‡†åº“å½“ä¸­å¹¶æ²¡æœ‰å†…å»ºçš„é›†åˆç±»å‹æ”¯æŒï¼Œè¿™å¤šå°‘æœ‰ç‚¹å¥‡æ€ªã€‚</p><p>æ•°ç»„å¾ˆå¥½ç”¨ï¼Œæˆ‘æ‡‚ï¼Œä½†æ˜¯å´æ²¡æœ‰é›†åˆçš„ <code>O(1)</code> å¤æ‚åº¦æŸ¥è¯¢å’Œå¹‚ç­‰æ€§ &mldr; <em>*å¹æ¯å£°*</em></p><p>æ‰€ä»¥ä¸‹é¢å¸¦æ¥ä¸€ä¸ª <code>Set</code> åœ¨ Swift å½“ä¸­å¯èƒ½çš„å®ç°ï¼Œä½¿ç”¨å†…ç½®çš„ <code>Dictionary</code> ç±»å‹åšä¸ºä¸‹å±‚æ”¯æŒï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Set</span>&lt;T: Hashable&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>typealias</span> Index = T
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>var</span> dictionary: [T: Bool] = [:]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> count: Int {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>.dictionary.count
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> isEmpty: Bool {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>.dictionary.isEmpty
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>contains</span>(element: T) -&gt; Bool {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>.dictionary[element] ?? <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>mutating</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>put</span>(element: T) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.dictionary[element] = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>mutating</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>remove</span>(element: T) -&gt; Bool {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>self</span>.contains(element) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>self</span>.dictionary.removeValueForKey(element)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>#         }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>ä¸€ä¸ªå®é™…ä½¿ç”¨çš„ï¼Œæ ‡å‡†åº“æ°´å¹³çš„ <code>Set</code> å®ç°å¸¦æœ‰çš„ Swift é£æ ¼ç‰¹æ€§ä¼š <em>å¤šå‡ºè®¸å¤š</em> ï¼Œä¾‹å¦‚ç”Ÿæˆå™¨ï¼Œåºåˆ—å’Œå„ç§å„æ ·åè®®çš„è¡Œä¸ºã€‚è¿™äº›å†…å®¹å°±è¶³ä»¥å•ç‹¬å†™ä¸€ç¯‡æ–‡ç« æ¥ä»‹ç»äº†ã€‚</p></blockquote><p>å½“ç„¶ï¼Œä¸€ä¸ªæ ‡å‡†é›†åˆç±»å‹åªæœ‰å¥½ç”¨æ‰æ˜¾å¾—æœ‰ç”¨ã€‚<code>NSSet</code> è¿æ°”å¹¶ä¸å¥½ï¼Œæ²¡æœ‰å—åˆ°ä¸€ç­‰å…¬æ°‘çš„å¾…é‡ï¼Œåƒæ•°ç»„å’Œå­—å…¸é‚£æ ·åœ¨ <a href=http://clang.llvm.org/docs/ObjectiveCLiterals.html>Apple LLVM Compiler 4.0</a> å½“ä¸­åŠ å…¥å¯¹äºå­—é¢å€¼è¯­æ³•çš„æ”¯æŒï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>ArrayLiteralConvertible</code> åè®®æ¥çº æ­£è¿™ä¸ªé”™è¯¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>ArrayLiteralConvertible</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>typealias</span> Element
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(arrayLiteral elements: Element...)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ‰©å±• <code>Set</code> ç±»å‹æ¥éµå¾ªè¿™ä¸ªåè®®çš„åšæ³•å¾ˆç®€æ˜ç›´æ¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Set</span>: ArrayLiteralConvertible {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>init</span>(arrayLiteral elements: T...) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> element <span style=color:#66d9ef>in</span> elements {
</span></span><span style=display:flex><span>            put(element)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™å°±è¶³å¤Ÿäº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»å®ç°äº†æƒ³è¾¾åˆ°çš„æ•ˆæœï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> set: Set = [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span>.contains(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// true</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span>.count <span style=color:#75715e>// 3</span>
</span></span></code></pre></div><blockquote><p>ç„¶è€Œè¿™ä¸ªä¾‹å­ä¹Ÿå‡¸æ˜¾äº†å­—é¢å€¼å¯è½¬æ¢ç‰¹æ€§çš„ä¸€ä¸ªå€¼å¾—æ‹…å¿§çš„åœ°æ–¹ï¼š<strong>ç±»å‹æ¨å¯¼æ­§ä¹‰</strong>ã€‚å› ä¸ºåƒ <code>Array</code> å’Œ <code>Set</code> è¿™æ ·çš„é›†åˆç±»å‹ä¹‹é—´æœ‰å¤§é‡çš„ API æ˜¯é‡å¤çš„ï¼Œå¾ˆå®¹æ˜“å†™å‡ºå…·æœ‰æ­§ä¹‰çš„ä»£ç ï¼Œå³åœ¨ç±»å‹ä¸åŒæ—¶å…·æœ‰ä¸åŒè¡¨ç°ï¼ˆä¾‹å¦‚ï¼Œé›†åˆæ·»åŠ å…ƒç´ æ˜¯å¹‚ç­‰çš„ï¼Œè€Œæ•°ç»„åˆ™æ˜¯å¢åŠ çš„ï¼Œå› æ­¤æ·»åŠ ä¸¤ä¸ªç›¸åŒçš„å…ƒç´ ä¹‹å count çš„å€¼ä¼šå‡ºç°å·®å¼‚ï¼‰ã€‚</p></blockquote><h2 id=stringliteralconvertible-å’Œ-urls>StringLiteralConvertible å’Œ URLs</h2><p>Alright, one last example creative use of literal convertibles: URL literals.</p><p>å¥½äº†ï¼Œæœ€åä¸€ä¸ªå¯Œæœ‰åˆ›æ„çš„å­—é¢å€¼å¯è½¬æ¢æ€§ç”¨æ³•ï¼šURL å­—é¢å€¼ã€‚</p><p><code>NSURL</code> æ˜¯ URL åŠ è½½ç³»ç»Ÿçš„æ³•å®šâ€é€šè´§â€œï¼Œå®ƒæœ‰ä¼˜ç§€çš„ç¬¦åˆ <a href=https://www.ietf.org/rfc/rfc2396.txt>RFC 2396</a> çš„å†…éƒ¨ç»„ä»¶è‡ªçœç‰¹æ€§ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒå¤ªéš¾åˆå§‹åŒ–äº†ï¼Œä»¥è‡³äºç¬¬ä¸‰æ–¹æ¡†æ¶çš„ä½œè€…ä»¬å¾€å¾€é€‰æ‹©æ”¾å¼ƒå®ƒï¼Œå»ä½¿ç”¨å·®ä¸€äº›ä½†æ˜¯æ›´åŠ æ–¹ä¾¿çš„å­—ç¬¦ä¸²ç±»å‹ä½œä¸ºæ–¹æ³•å‚æ•°ã€‚</p><p>åœ¨ <code>NSURL</code> ä¸Šä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ‰©å±•ï¼Œå°±å¯ä»¥å…¼é¡¾ä¸¤è€…çš„å¥½å¤„äº†ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>NSURL</span>: StringLiteralConvertible {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>func</span> convertFromExtendedGraphemeClusterLiteral(value: String) -&gt; <span style=color:#66d9ef>Self</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>(string: value)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>func</span> convertFromStringLiteral(value: String) -&gt; <span style=color:#66d9ef>Self</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>self</span>(string: value)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å­—é¢å€¼å¯è½¬æ¢æ€§çš„å¦ä¸€ä¸ªä¸é”™çš„ç‰¹æ€§æ˜¯ï¼Œç±»å‹æ¨å¯¼ç”šè‡³ä¸éœ€è¦å˜é‡å®šä¹‰ä¹Ÿå¯ä»¥å·¥ä½œï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#e6db74>&#34;https://nshipster.com/&#34;</span>.host <span style=color:#75715e>// nshipster.com</span>
</span></span></code></pre></div><hr><p>ä½œä¸ºç¤¾åŒºä¸­çš„ä¸€å‘˜ï¼Œåˆ¤æ–­ Swift çš„åŠŸèƒ½å½“ä¸­å“ªäº›æ˜¯ç‰¹æ€§ï¼Œå“ªäº›æ˜¯ bug æ­£æ˜¯æˆ‘ä»¬çš„è´£ä»»ã€‚æˆ‘ä»¬æ¥å†³å®šå“ªäº›è®¾è®¡æ˜¯æ¨¡å¼ï¼Œå“ªäº›è®¾è®¡æ˜¯åæ¨¡å¼ï¼Œå“ªäº›æ˜¯æƒ¯ä¾‹ï¼Œå“ªäº›æ˜¯å±é™©ç”¨æ³•ã€‚</p><p>è¯¸å¦‚å­—é¢å€¼å¯è½¬æ¢æ€§ï¼Œè‡ªå®šä¹‰æ“ä½œç¬¦ï¼Œå’Œå…¶å®ƒæ‰€æœ‰çš„ Swift åŠŸèƒ½å°†æ¥ä¼šå¦‚ä½•åè°ƒå·¥ä½œï¼Œç°åœ¨è¿˜å°šä¸æ¸…æ™°ã€‚è¿™ä¸ªç½‘ç«™çš„æ–‡ç« åœ¨æŸäº›æ—¶å€™ä¼šå¯¹äº‹æƒ…åº”è¯¥æ€ä¹ˆåšè¿›è¡Œä¸€äº›è§„å®šæ€§çš„è¯´æ˜ï¼Œä½†æ˜¯å¯¹äºè¿™ç¯‡æ–‡ç« è€Œè¨€ï¼Œå¹¶ä¸æ˜¯è¿™ç§æƒ…å†µã€‚</p><p>æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…å°±æ˜¯æ¢ç´¢å’Œå­¦ä¹ ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2014-08-18 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Swift target=_blank>Swift</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>