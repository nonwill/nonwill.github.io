<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>Never</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="Never,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="Never,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>Never</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>Xiang Wang</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>â€œNeverâ€æ˜¯ä¸€ä¸ªçº¦å®šï¼Œè¡¨ç¤ºä¸€ä»¶äº‹åœ¨è¿‡å»æˆ–æœªæ¥çš„ä»»ä½•æ—¶æ®µéƒ½ä¸ä¼šå‘ç”Ÿã€‚å®ƒæ˜¯æ—¶é—´è½´ä¸Šçš„ä¸€ç§é€»è¾‘ä¸Šçš„ä¸å¯èƒ½ï¼Œåœ¨ä»»ä½•æ–¹å‘å»¶å±•å¼€å»éƒ½æ²¡æœ‰å¯èƒ½ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ä»£ç ä¸­çœ‹åˆ° <a href="https://github.com/search?q=%22this+will+never+happen%22&type=Code">è¿™æ ·çš„æ³¨é‡Š</a> ä¼šç‰¹åˆ«è®©äººä¸å®‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// this will never happen</span>
</span></span></code></pre></div><p>æ‰€æœ‰ç¼–è¯‘å™¨çš„æ•™ç§‘ä¹¦éƒ½ä¼šå‘Šè¯‰ä½ ï¼Œè¿™æ ·ä¸€å¥æ³¨é‡Šä¸èƒ½ä¹Ÿä¸ä¼šå¯¹ç¼–è¯‘å‡ºçš„ä»£ç äº§ç”Ÿä»»ä½•å½±å“ã€‚<a href=https://en.wikipedia.org/wiki/Murphy%27s_law>å¢¨è²å®šç†</a> å‘Šè¯‰ä½ å¹¶éå¦‚æ­¤ï¼Œæ³¨é‡Šä»¥ä¸‹çš„ä»£ç ä¸€å®šä¼šè¢«è§¦å‘ã€‚</p><p>é‚£ Swift æ˜¯å¦‚ä½•åœ¨è¿™ç§æ— æ³•é¢„æµ‹çš„ã€æ··ä¹±çš„å¼€å‘è¿‡ç¨‹ä¸­ä¿è¯å®‰å…¨å‘¢ï¼Ÿç­”æ¡ˆéš¾ä»¥ç½®ä¿¡ï¼šâ€œ<strong>ä»€ä¹ˆéƒ½ä¸åš</strong>â€ï¼Œä»¥åŠâ€œ<strong>å´©æºƒ</strong>â€ã€‚</p><hr><p>ä½¿ç”¨ <code>Never</code> æ›¿æ¢ <code>@noreturn</code> ä¿®é¥°ç¬¦ï¼Œæ˜¯ç”± <a href=https://github.com/jckarter>Joe Groff</a> åœ¨ <a href=https://github.com/apple/swift-evolution/blob/master/proposals/0102-noreturn-bottom-type.md>SE-0102: â€œRemove @noreturn attribute and introduce an empty Never typeâ€</a> ä¸­æå‡ºçš„ã€‚</p><p>åœ¨ Swift 3 ä¹‹å‰ï¼Œé‚£äº›è¦ä¸­æ–­æ‰§è¡Œçš„å‡½æ•°ï¼Œæ¯”å¦‚ <code>fatalError(_:file:line:)</code>ï¼Œ<code>abort()</code> å’Œ <code>exit(_:)</code>ï¼Œéœ€è¦ä½¿ç”¨ <code>@noreturn</code> ä¿®é¥°ç¬¦æ¥å£°æ˜ï¼Œè¿™ä¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ‰§è¡Œå®Œæˆä¹‹åä¸ç”¨è¿”å›åˆ°è°ƒç”¨æ–¹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// Swift &lt; 3.0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@noreturn</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>fatalError</span>(<span style=color:#66d9ef>_</span> message: () -&gt; String = String(),
</span></span><span style=display:flex><span>                               file: StaticString = <span style=color:#66d9ef>#file</span>,
</span></span><span style=display:flex><span>                               line: UInt = <span style=color:#66d9ef>#line</span>)
</span></span></code></pre></div><p>ä» Swift 3 å¼€å§‹ï¼Œ<code>fatalError</code> å’Œå®ƒçš„ç›¸å…³å‡½æ•°éƒ½è¢«å£°æ˜ä¸ºè¿”å› <code>Never</code> ç±»å‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// Swift &gt;= 3.0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>fatalError</span>(<span style=color:#66d9ef>_</span> message: <span style=color:#66d9ef>@autoclosure</span> () -&gt; String = String(),
</span></span><span style=display:flex><span>                     file: StaticString = <span style=color:#66d9ef>#file</span>,
</span></span><span style=display:flex><span>                     line: UInt = <span style=color:#66d9ef>#line</span>) -&gt; Never
</span></span></code></pre></div><p>ä½œä¸ºä¸€ä¸ªæ³¨é‡Šçš„æ›¿ä»£å“ï¼Œå®ƒè‚¯å®šæ˜¯å¾ˆå¤æ‚çš„ï¼Œå¯¹å—ï¼ŸNOï¼äº‹å®ä¸Šï¼Œæ°æ°ç›¸åï¼Œ<code>Never</code> å¯ä»¥è¯´æ˜¯æ•´ä¸ª Swift æ ‡å‡†åº“ä¸­æœ€ç®€å•çš„ä¸€ä¸ªç±»å‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Never</span> {}
</span></span></code></pre></div><h2 id=æ— å®ä¾‹ç±»å‹uninhabited-types>æ— å®ä¾‹ç±»å‹ï¼ˆUninhabited Typesï¼‰</h2><p><code>Never</code> æ˜¯ä¸€ä¸ª <em>æ— å®ä¾‹</em>ï¼ˆ<em>Uninhabited</em>ï¼‰ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ²¡æœ‰ä»»ä½•å€¼ã€‚æˆ–è€…æ¢å¥è¯è¯´ï¼Œæ— å®ä¾‹ç±»å‹æ˜¯æ— æ³•è¢«æ„å»ºçš„ã€‚</p><p>åœ¨ Swift ä¸­ï¼Œæ²¡æœ‰å®šä¹‰ä»»ä½• <code>case</code> çš„æšä¸¾æ˜¯æœ€å¸¸è§çš„ä¸€ç§æ— å®ä¾‹ç±»å‹ã€‚è·Ÿç»“æ„ä½“å’Œç±»ä¸åŒï¼Œæšä¸¾æ²¡æœ‰åˆå§‹åŒ–æ–¹æ³•ã€‚è·Ÿåè®®ä¹Ÿä¸åŒï¼Œæšä¸¾æ˜¯ä¸€ä¸ªå…·ä½“çš„ç±»å‹ï¼Œå¯ä»¥åŒ…å«å±æ€§ã€æ–¹æ³•ã€æ³›å‹çº¦æŸå’ŒåµŒå¥—ç±»å‹ã€‚æ­£å› å¦‚æ­¤ï¼ŒSwift æ ‡å‡†åº“å¹¿æ³›ä½¿ç”¨æ— å®ä¾‹çš„æšä¸¾ç±»å‹æ¥åšè¯¸å¦‚ <a href=https://github.com/apple/swift/blob/a4230ab2ad37e37edc9ed86cd1510b7c016a769d/stdlib/public/core/Unicode.swift#L918>å®šä¹‰å‘½åç©ºé—´</a> ä»¥åŠ <a href=https://github.com/apple/swift/blob/a6952decab6f918a9df3c6fa342153a9f9204f8e/stdlib/public/core/MemoryLayout.swift#L43>æ ‡è¯†ç±»å‹çš„å«ä¹‰</a> ä¹‹ç±»çš„äº‹æƒ…ã€‚</p><p>ä½† <code>Never</code> å¹¶ä¸è¿™æ ·ã€‚å®ƒæ²¡æœ‰ä»€ä¹ˆèŠ±å“¨çš„ä¸œè¥¿ï¼Œå®ƒçš„ç‰¹åˆ«ä¹‹å¤„å°±åœ¨äºï¼Œå®ƒå°±æ˜¯å®ƒè‡ªå·±ï¼ˆæˆ–è€…è¯´ï¼Œå®ƒä»€ä¹ˆéƒ½ä¸æ˜¯ï¼‰ã€‚</p><p>è¯•æƒ³ä¸€ä¸ªè¿”å›å€¼ä¸ºæ— å®ä¾‹ç±»å‹çš„å‡½æ•°ï¼šå› ä¸ºæ— å®ä¾‹ç±»å‹æ²¡æœ‰ä»»ä½•å€¼ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°æ— æ³•æ­£å¸¸çš„è¿”å›ã€‚ï¼ˆå®ƒè¦å¦‚ä½•ç”Ÿæˆè¿™ä¸ªè¿”å›å€¼å‘¢ï¼Ÿï¼‰æ‰€ä»¥ï¼Œè¿™ä¸ªå‡½æ•°è¦ä¹ˆåœæ­¢è¿è¡Œï¼Œè¦ä¹ˆæ— ä¼‘æ­¢çš„ä¸€ç›´è¿è¡Œä¸‹å»ã€‚</p><h2 id=æ¶ˆé™¤æ³›å‹ä¸­çš„ä¸å¯èƒ½çŠ¶æ€>æ¶ˆé™¤æ³›å‹ä¸­çš„ä¸å¯èƒ½çŠ¶æ€</h2><p>ä»ç†è®ºè§’åº¦ä¸Šè¯´ï¼Œ<code>Never</code> ç¡®å®å¾ˆæœ‰æ„æ€ï¼Œä½†å®ƒåœ¨å®é™…åº”ç”¨ä¸­åˆèƒ½å¸®æˆ‘ä»¬åšä»€ä¹ˆå‘¢ï¼Ÿ</p><p>åšä¸äº†ä»€ä¹ˆï¼Œè‡³å°‘åœ¨ <a href=https://github.com/apple/swift-evolution/blob/master/proposals/0215-conform-never-to-hashable-and-equatable.md#conform-never-to-equatable-and-hashable>SE-0215: Conform Never to Equatable and Hashable</a> æ¨å‡ºä»¥å‰ï¼Œåšä¸äº†ä»€ä¹ˆã€‚</p><p><a href=https://github.com/mdiep>Matt Diephouse</a> åœ¨ææ¡ˆä¸­è§£é‡Šäº†ä¸ºä»€ä¹ˆè®©è¿™ä¸ªä»¤äººè´¹è§£çš„ç±»å‹å»éµå®ˆ <code>Equatable</code> å’Œå…¶ä»–åè®®ï¼š</p><blockquote><p><code>Never</code> åœ¨è¡¨ç¤ºä¸å¯èƒ½æ‰§è¡Œçš„ä»£ç æ–¹é¢éå¸¸æœ‰ç”¨ã€‚å¤§éƒ¨åˆ†äººç†Ÿæ‚‰å®ƒï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ <code>fatalError</code> ç­‰æ–¹æ³•çš„è¿”å›å€¼ï¼Œä½† <code>Never</code> åœ¨æ³›å‹æ–¹é¢ä¹Ÿéå¸¸æœ‰ç”¨ã€‚æ¯”å¦‚è¯´ï¼Œä¸€ä¸ª <code>Result</code> ç±»å‹å¯ä»¥ä½¿ç”¨ <code>Never</code> ä½œä¸ºå®ƒçš„ <code>Value</code>ï¼Œè¡¨ç¤ºæŸç§ä¸œè¥¿ä¸€ç›´æ˜¯é”™è¯¯çš„ï¼Œæˆ–è€…ä½¿ç”¨ <code>Never</code> ä½œä¸ºå®ƒçš„ <code>Error</code>ï¼Œè¡¨ç¤ºæŸç§ä¸œè¥¿ä¸€ç›´ä¸æ˜¯é”™è¯¯çš„ã€‚</p></blockquote><p>Swift æ²¡æœ‰æ ‡å‡†çš„ <code>Result</code> ç±»å‹ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å®ƒä»¬æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Result</span>&lt;Value, Error: Swift.Error&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> success(Value)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> failure(Error)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>Result</code> ç±»å‹è¢«ç”¨æ¥å°è£…å¼‚æ­¥æ“ä½œç”Ÿæˆçš„è¿”å›å€¼å’Œå¼‚å¸¸ï¼ˆåŒæ­¥æ“ä½œå¯ä»¥ä½¿ç”¨ <code>throw</code> æ¥è¿”å›å¼‚å¸¸ï¼‰ã€‚</p><p>æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªå‘é€å¼‚æ­¥ HTTP è¯·æ±‚çš„å‡½æ•°å¯èƒ½ä½¿ç”¨ <code>Result</code> ç±»å‹æ¥å­˜å‚¨å“åº”æˆ–é”™è¯¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#66d9ef>_</span> request: Request, completion: (Result&lt;Response, Error&gt;) -&gt; Void) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è°ƒç”¨è¿™ä¸ªæ–¹æ³•åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>switch</code> æ¥åˆ†åˆ«å¤„ç†å®ƒçš„ <code>.success</code> å’Œ <code>.failure</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>fetch(request) { result <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> result {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .success(<span style=color:#66d9ef>let</span> value):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Success: </span><span style=color:#e6db74>\(</span>value<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .failure(<span style=color:#66d9ef>let</span> error):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Failure: </span><span style=color:#e6db74>\(</span>error<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ç°åœ¨å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•°ä¼šåœ¨å®ƒçš„ <code>completion</code> ä¸­æ°¸è¿œè¿”å›æˆåŠŸç»“æœï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>alwaysSucceeds</span>(<span style=color:#66d9ef>_</span> completion: (Result&lt;String, Never&gt;) -&gt; Void) {
</span></span><span style=display:flex><span>    completion(.success(<span style=color:#e6db74>&#34;yes!&#34;</span>))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å°† <code>Result</code> çš„ <code>Error</code> ç±»å‹æŒ‡å®šä¸º <code>Never</code> åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»å‹æ£€æµ‹ä½“ç³»æ¥è¡¨æ˜å¤±è´¥æ˜¯æ°¸è¿œä¸å¯èƒ½å‘ç”Ÿçš„ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œä½ ä¸éœ€è¦å¤„ç† <code>.failure</code>ï¼ŒSwift å¯ä»¥æ¨æ–­å‡ºè¿™ä¸ª <code>switch</code> è¯­å¥å·²ç»å¤„ç†äº†æ‰€æœ‰æƒ…å†µã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>alwaysSucceeds { (result) <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> result {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .success(<span style=color:#66d9ef>let</span> string):
</span></span><span style=display:flex><span>        print(string)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯è®© <code>Never</code> éµå¾ª <code>Comparable</code> åè®®ï¼Œè¿™æ®µä»£ç æŠŠ <code>Never</code> ç”¨åˆ°äº†æè‡´ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Never</span>: Comparable {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#f92672>&lt;</span> (lhs: Never, rhs: Never) -&gt; Bool {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (lhs, rhs) {}
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å› ä¸º <code>Never</code> æ˜¯ä¸€ä¸ªæ— å®ä¾‹ç±»å‹ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰ä»»ä½•å¯èƒ½çš„å€¼ã€‚æ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨ <code>switch</code> éå†å®ƒçš„ <code>lhs</code> å’Œ <code>rhs</code> æ—¶ï¼ŒSwift å¯ä»¥ç¡®å®šæ‰€æœ‰çš„å¯èƒ½æ€§éƒ½éå†äº†ã€‚æ—¢ç„¶æ‰€æœ‰çš„å¯èƒ½æ€§ â€” å®é™…ä¸Šè¿™é‡Œä¸å­˜åœ¨ä»»ä½•å€¼ â€” éƒ½è¿”å›äº† <code>Bool</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±å¯ä»¥æ­£å¸¸ç¼–è¯‘ã€‚</p><p><em>å·¥æ•´ï¼</em></p><h2 id=ä½¿ç”¨-never-ä½œä¸ºå…œåº•ç±»å‹>ä½¿ç”¨ <code>Never</code> ä½œä¸ºå…œåº•ç±»å‹</h2><p>å®é™…ä¸Šï¼Œå…³äº <code>Never</code> çš„ Swift Evolution ææ¡ˆä¸­å·²ç»æš—ç¤ºäº†è¿™ä¸ªç±»å‹åœ¨æœªæ¥å¯èƒ½æœ‰æ›´å¤šç”¨å¤„ï¼š</p><blockquote><p>ä¸€ä¸ªæ— å®ä¾‹ç±»å‹å¯ä»¥ä½œä¸ºå…¶ä»–ä»»æ„ç±»å‹çš„å­ç±»å‹ â€” å¦‚æœæŸä¸ªè¡¨è¾¾å¼æ ¹æœ¬ä¸å¯èƒ½äº§ç”Ÿä»»ä½•ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªè¡¨è¾¾å¼çš„ç±»å‹åˆ°åº•æ˜¯ä»€ä¹ˆã€‚å¦‚æœç¼–è¯‘å™¨æ”¯æŒè¿™ä¸€ç‰¹æ€§ï¼Œå°±å¯ä»¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½â€¦â€¦</p></blockquote><h3 id=è§£åŒ…æˆ–è€…æ­»äº¡>è§£åŒ…æˆ–è€…æ­»äº¡</h3><p>å¼ºåˆ¶è§£åŒ…æ“ä½œï¼ˆ<code>!</code>ï¼‰æ˜¯ Swift ä¸­æœ€å…·äº‰è®®çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚ï¼ˆåœ¨ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦ï¼‰å¾€å¥½äº†è¯´ï¼Œæ˜¯æœ‰æ„ä¸ºä¹‹ï¼ˆåœ¨å¼‚å¸¸æ—¶æ•…æ„è®©ç¨‹åºå´©æºƒï¼‰ï¼›å¾€åäº†è¯´ï¼Œå¯èƒ½è¡¨ç¤ºä½¿ç”¨è€…æ²¡æœ‰è®¤çœŸæ€è€ƒã€‚åœ¨ç¼ºä¹å…¶ä»–ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå¾ˆéš¾çœ‹å‡ºè¿™ä¸¤è€…çš„åŒºåˆ«ã€‚</p><p>æ¯”å¦‚ï¼Œä¸‹é¢çš„ä»£ç å‡å®šæ•°ç»„ä¸€å®šä¸ä¸ºç©ºï¼Œ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> array: [Int]
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> firstIem = array.first!
</span></span></code></pre></div><p>ä¸ºäº†é¿å…å¼ºåˆ¶è§£åŒ…ï¼Œä½ å¯ä»¥ä½¿ç”¨å¸¦æ¡ä»¶èµ‹å€¼çš„ <code>guard</code> è¯­å¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> array: [Int]
</span></span><span style=display:flex><span><span style=color:#66d9ef>guard</span> <span style=color:#66d9ef>let</span> firstItem = array.first <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    fatalError(<span style=color:#e6db74>&#34;array cannot be empty&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æœªæ¥ï¼Œå¦‚æœ <code>Never</code> æˆä¸ºå…œåº•ç±»å‹ï¼Œå®ƒå°±å¯ä»¥ç”¨åœ¨ <code>nil-coalescing operator</code> è¡¨è¾¾å¼çš„å³è¾¹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// æœªæ¥çš„ Swift å†™æ³•? ğŸ”®</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> firstItem = array.first ?? fatalError(<span style=color:#e6db74>&#34;array cannot be empty&#34;</span>)
</span></span></code></pre></div><p>å¦‚æœä½ æƒ³ç°åœ¨å°±ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œå¯ä»¥æ‰‹åŠ¨é‡è½½ <code>??</code> è¿ç®—ç¬¦ï¼ˆä½†æ˜¯â€¦â€¦ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> ?? &lt;T&gt;(lhs: T?, rhs: <span style=color:#66d9ef>@autoclosure</span> () -&gt; Never) -&gt; T {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> lhs {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#66d9ef>let</span> value?:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> value
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#66d9ef>nil</span>:
</span></span><span style=display:flex><span>        rhs()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>åœ¨æ‹’ç» <a href=https://github.com/apple/swift-evolution/blob/master/proposals/0217-bangbang.md#on-forced-unwraps>SE-0217: Introducing the !! â€œUnwrap or Dieâ€ operator to the Swift Standard Library</a> çš„<a href=https://forums.swift.org/t/se-0217-the-unwrap-or-die-operator/14107/222>åŸå› è¯´æ˜</a>ä¸­, <a href=https://github.com/jckarter>Joe Groff</a> æåˆ°ï¼Œâ€œæˆ‘ä»¬å‘ç°é‡è½½ [?? for Never] ä¼šå¯¹ç±»å‹æ£€æµ‹çš„æ€§èƒ½äº§ç”Ÿéš¾ä»¥æ¥å—çš„å½±å“â€ã€‚æ‰€ä»¥ï¼Œä¸å»ºè®®ä½ åœ¨è‡ªå·±çš„ä»£ç ä¸­æ·»åŠ ä¸Šé¢çš„ä»£ç ã€‚</p></blockquote><h3 id=è¡¨è¾¾å¼é£æ ¼çš„-throw>è¡¨è¾¾å¼é£æ ¼çš„ Throw</h3><p>ç±»ä¼¼çš„ï¼Œå¦‚æœ <code>throw</code> å¯ä»¥ä»è¯­å¥å˜æˆä¸€ä¸ªè¿”å› <code>Never</code>çš„è¡¨è¾¾å¼ï¼Œä½ å°±å¯ä»¥åœ¨ <code>??</code> å³è¾¹ä½¿ç”¨ <code>throw</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// æœªæ¥çš„ Swift å†™æ³•? ğŸ”®</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> firstItem = array.first ?? <span style=color:#66d9ef>throw</span> Error.empty
</span></span></code></pre></div><h3 id=å¸¦ç±»å‹çš„-throw>å¸¦ç±»å‹çš„ Throw</h3><p>ç»§ç»­ç ”ç©¶ä¸‹å»ï¼šå¦‚æœå‡½æ•°å£°æ˜çš„ <code>throw</code> å…³é”®å­—æ”¯æŒç±»å‹çº¦æŸï¼Œé‚£ä¹ˆ <code>Never</code> å¯ä»¥ç”¨æ¥è¡¨æ˜æŸä¸ªå‡½æ•°ç»å¯¹ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆç±»ä¼¼äºåœ¨ä¸Šé¢çš„ <code>Result</code> ä¾‹å­ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// æœªæ¥çš„ Swift å†™æ³•? ğŸ”®</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>neverThrows</span>() <span style=color:#66d9ef>throws</span>&lt;Never&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>neverThrows() <span style=color:#75715e>// æ— éœ€ä½¿ç”¨ `try` ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¿è¯å®ƒä¸€å®šæˆåŠŸï¼ˆå¯èƒ½ï¼‰</span>
</span></span></code></pre></div><hr><p>å£°ç§°æŸä¸ªäº‹æƒ…æ°¸è¿œä¸å¯èƒ½å‘ç”Ÿï¼Œå°±åƒæ˜¯å‘æ•´ä¸ªå®‡å®™å‘å‡ºé‚€è¯·ï¼Œæ¥è¯æ˜å®ƒæ˜¯é”™çš„ä¸€æ ·ã€‚æƒ…æ€é€»è¾‘ï¼ˆmodal logicï¼‰æˆ–è€…ä¿¡å¿µé€»è¾‘ï¼ˆdoxastic logicï¼‰å…è®¸ä¿é¢å­å¼çš„å¦¥åï¼ˆâ€œ<em>å®ƒå½“æ—¶æ˜¯å¯¹çš„ï¼Œè‡³å°‘æˆ‘æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„ï¼</em>â€ï¼‰ï¼Œä½†æ—¶æ€é€»è¾‘ï¼ˆtemporal logicï¼‰ä¼¼ä¹å°†è¿™ä¸ªçº¦å®šæåˆ°äº†æ›´é«˜çš„ä¸€ä¸ªæ ‡å‡†ã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œå¾—ç›Šäºæœ€ä¸åƒç±»å‹çš„ <code>Never</code>ï¼ŒSwift åˆ°è¾¾äº†è¿™ä¸ªé«˜æ ‡å‡†ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2018-07-30 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Swift target=_blank>Swift</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>