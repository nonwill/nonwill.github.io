<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>CloudKit</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="CloudKit,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="CloudKit,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>CloudKit</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Croath Liu</span> <span title="Translator Â· ç¿»è¯‘" class=author><a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>ä½œä¸º iOS å¼€å‘è€…ï¼Œå¦‚æœæƒ³è‡ªå·±ç‹¬ç«‹åˆ¶ä½œåº”ç”¨ï¼Œæœ‰æ—¶å¯èƒ½éœ€è¦å†™ä¸€äº›åç«¯ä»£ç ã€‚å³ä½¿å¯¹äºèƒ½å¤Ÿèƒœä»»è¿™é¡¹å·¥ä½œçš„ç§»åŠ¨å¼€å‘è€…è€Œè¨€ï¼Œè¿™ä¸ä»…æ„å‘³ç€è¦å†™ä»£ç ï¼Œè·Ÿå¤šçš„æ˜¯é•¿æœŸç»´æŠ¤ã€‚æœ€ç³Ÿç³•çš„æƒ…å†µå¯èƒ½å¹¶ä¸æ˜¯å¤§å®¶ä¸å–œæ¬¢ä½ çš„åº”ç”¨ï¼Œè€Œæ˜¯åœ¨å·¨å¤§æµé‡å‹åŠ›ä¸‹ä½ çš„æœåŠ¡å™¨å®•æœºäº†ã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ CloudKit äº†ã€‚è‹¹æœæ›¿æˆ‘ä»¬æ“å¿ƒè¿™äº›äº‹æƒ…ï¼Œä½ åªç®¡è®©åº”ç”¨å˜å¾—å®Œç¾ã€‚</p><h2 id=ä»€ä¹ˆæ˜¯-cloudkit>ä»€ä¹ˆæ˜¯ CloudKit?</h2><p>åœ¨æ­¤ä¹‹å‰å¯èƒ½ä½ å·²ç»çŸ¥é“ iCloud Drive äº†â€”â€”iCloud Drive æ˜¯å¯ä»¥å­˜å‚¨ç”¨æˆ·æ•°æ®å’Œæ–‡ä»¶çš„åœ°æ–¹ï¼Œä»¥ä¾¿åœ¨å…¶ä»–è®¾å¤‡ä¹Ÿèƒ½å¤Ÿè®¿é—®ã€‚CloudKit åˆ™æ˜¯å¸®åŠ©æˆ‘ä»¬åœ¨åº”ç”¨é‡Œä¹Ÿèƒ½å¤Ÿè½»æ¾è®¿é—®è¿™äº›æ•°æ®çš„æ¡†æ¶ã€‚</p><p>CloudKit æä¾› API è®©ä½ èƒ½å¤Ÿè®¿é—® iCloud æœåŠ¡å™¨ï¼›å®ƒå¯ä»¥ä½¿ç”¨ç”¨æˆ·çš„ iCloud è´¦æˆ·æ¥åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”æ‹¥æœ‰å¯ä¾›æ¯ä¸ªç”¨æˆ·è®¿é—®çš„å…¬å¼€æƒé™çš„æ•°æ®åº“ï¼Œä»¥åŠæ¯ä¸ªç”¨æˆ·è‡ªå·±çš„ç§æœ‰æ•°æ®åº“æ¥å­˜å‚¨ä¿¡æ¯ï¼›ä½ ä¹Ÿå¯ä»¥é€šè¿‡ CloudKit çš„æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿæ¥å­˜å‚¨ç»“æ„åŒ–æ•°æ®å’Œå¤§æ–‡ä»¶ï¼›è¿™ä¸€åˆ‡éƒ½ä¸ä»…ä»…å‘ç”Ÿåœ¨ç”¨æˆ·æœ¬åœ°ï¼Œæ•°æ®è¢«å­˜å‚¨åœ¨äº‘ç«¯ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä»»æ„å…¶å®ƒè®¾å¤‡ä¸Šè®¿é—®ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒCloudKit æ˜¯ä½ æ‰€ç†ŸçŸ¥çš„æ•°æ®åº“ã€æ–‡ä»¶å­˜å‚¨ã€ç”¨æˆ·è®¤è¯ç³»ç»Ÿçš„é›†åˆæœåŠ¡ã€‚æœ‰äº† CloudKit çš„å¸®åŠ©ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒè¿™äº›æ•°æ®åº“ä»€ä¹ˆçš„ï¼Œåªè¦ä¸“æ³¨åœ¨åº”ç”¨å¼€å‘ä¸Šå°±å¥½äº†ã€‚</p><h2 id=å¼€å§‹ä½¿ç”¨-cloudkit>å¼€å§‹ä½¿ç”¨ CloudKit</h2><p>æƒ³è±¡ç°åœ¨ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç­¾åˆ°ç±»çš„åº”ç”¨ï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ ä¸€äº›å¸¦æœ‰ä½ç½®ä¿¡æ¯çš„ã€Œåœ°ç‚¹ã€ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™äº›åœ°ç‚¹ç­¾åˆ°ã€‚ä¸‹é¢æˆ‘ä»¬å°±è®²è®¨è®ºå¦‚ä½•ä½¿ç”¨ CloudKit æ„å»ºè¿™ä¸ªåº”ç”¨æ‰€éœ€è¦çš„åŸºæœ¬åŠŸèƒ½ã€‚</p><h3 id=å¼€å¯-cloudkit>å¼€å¯ CloudKit</h3><p>æ—¢ç„¶ CloudKit è¿™ä¹ˆå¼ºå¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•å¼€å¯å®ƒã€‚å¾ˆç®€å•ï¼Œåœ¨ Xcode çš„é¡¹ç›®è®¾ç½®ç•Œé¢æ‰“å¼€ iCloud å¼€å…³å¹¶å‹¾é€‰ CloudKit å°±å¯ä»¥äº†ï¼š</p><p><img alt="Enabling CloudKit in Xcode" src=/media/NSHipster/cloudkit-xcode.png></p><h3 id=cloudkit-åŸºç¡€å¯¹è±¡ç±»å‹>CloudKit åŸºç¡€å¯¹è±¡ç±»å‹</h3><p>CloudKit çš„åŸºç¡€å¯¹è±¡ç±»å‹æœ‰ 7 ç§ã€‚è¿™äº›å¯¹è±¡ç±»å‹å¯èƒ½å’Œä½ åœ¨å…¶ä»–ç¼–ç¨‹é¢†åŸŸäº†è§£çš„ç±»ä¼¼å¯¹è±¡ç±»å‹ç¨æœ‰å·®åˆ«ã€‚</p><ul><li><p><code>CKContainer</code>: Containers å°±åƒåº”ç”¨è¿è¡Œçš„æ²™ç›’ä¸€æ ·ï¼Œä¸€ä¸ªåº”ç”¨åªèƒ½è®¿é—®è‡ªå·±æ²™ç›’ä¸­çš„å†…å®¹è€Œä¸èƒ½è®¿é—®å…¶ä»–åº”ç”¨çš„ã€‚Containers å°±æ˜¯æœ€å¤–å±‚å®¹å™¨ï¼Œæ¯ä¸ªåº”ç”¨æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„ containerã€‚ï¼ˆäº‹å®ä¸Šï¼Œç»è¿‡å¼€å‘è€…æˆæƒé…ç½® CloudKit Dashboard ä¹‹åï¼Œä¸€ä¸ªåº”ç”¨ä¹Ÿå¯ä»¥è®¿é—®å…¶ä»–åº”ç”¨çš„ containerã€‚ï¼‰</p></li><li><p><code>CKDatabase</code>: Database å³æ•°æ®åº“ï¼Œç§æœ‰æ•°æ®åº“ç”¨æ¥å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ç”¨æˆ·çš„æ€§åˆ«å¹´é¾„ç­‰ï¼Œç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„ç§æœ‰æ•°æ®åº“ã€‚åº”ç”¨ä¹Ÿæœ‰ä¸€ä¸ªå…¬å¼€çš„æ•°æ®åº“æ¥å­˜å‚¨å…¬å…±ä¿¡æ¯ï¼Œä¾‹å¦‚ä½ åœ¨æ„å»ºä¸€ä¸ªæ ¹æ®åœ°ç†ä½ç½®ç­¾åˆ°çš„åº”ç”¨ï¼Œé‚£ä¹ˆåœ°ç†ä½ç½®ä¿¡æ¯å°±åº”è¯¥å­˜å‚¨åœ¨å…¬å…±æ•°æ®åº“é‡Œä»¥ä¾¿æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½è®¿é—®åˆ°ã€‚</p></li><li><p><code>CKRecord</code>: å³æ•°æ®åº“ä¸­çš„ä¸€æ¡æ•°æ®è®°å½•ã€‚CloudKit ä½¿ç”¨ record é€šè¿‡ k/v ç»“æ„æ¥å­˜å‚¨ç»“æ„åŒ–æ•°æ®ã€‚å…³äºé”®å€¼å­˜å‚¨ï¼Œç›®å‰å€¼çš„æ¶æ„æ”¯æŒ NSStringã€NSNumberã€NSDataã€NSDateã€CLLocationï¼Œå’Œ CKReferenceã€CKAssetï¼ˆè¿™ä¸¤ä¸ªä¸‹é¢æˆ‘ä»¬ä¼šè¯´æ˜ï¼‰ï¼Œä»¥åŠå­˜å‚¨ä»¥ä¸Šæ•°æ®ç±»å‹çš„æ•°ç»„ã€‚</p></li><li><p><code>CKRecordZone</code>: Record ä¸æ˜¯ä»¥é›¶æ•£çš„æ–¹å¼å­˜åœ¨äº database ä¹‹ä¸­çš„ï¼Œå®ƒä»¬ä½äº record zones é‡Œã€‚æ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ª default record zoneï¼Œä½ ä¹Ÿå¯ä»¥æœ‰è‡ªå®šä¹‰çš„ record zoneã€‚</p></li><li><p><code>CKRecordIdentifier</code>: æ˜¯ä¸€æ¡ record çš„å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºç¡®å®šè¯¥ record åœ¨æ•°æ®åº“ä¸­çš„å”¯ä¸€ä½ç½®ã€‚</p></li><li><p><code>CKReference</code>: Reference å¾ˆåƒ RDBMS ä¸­çš„å¼•ç”¨å…³ç³»ã€‚è¿˜æ˜¯ä»¥åœ°ç†ä½ç½®ç­¾åˆ°åº”ç”¨ä¸ºä¾‹ï¼Œæ¯ä¸ªåœ°ç†ä½ç½®å¯ä»¥åŒ…å«å¾ˆå¤šç”¨æˆ·åœ¨è¯¥ä½ç½®çš„ç­¾åˆ°ï¼Œé‚£ä¹ˆä½ç½®ä¸ç­¾åˆ°ä¹‹é—´å°±å½¢æˆäº†è¿™æ ·ä¸€ç§åŒ…å«å¼çš„ä»å±å…³ç³»ã€‚</p></li><li><p><code>CKAsset</code>: å³èµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿˜æ˜¯ä»¥ç­¾åˆ°åº”ç”¨ä¸ºä¾‹ï¼Œç”¨æˆ·ç­¾åˆ°æ—¶å¯èƒ½è¿˜åŒ…å«ä¸€å¼ ç…§ç‰‡ï¼Œé‚£ä¹ˆè¿™å¼ ç…§ç‰‡å°±ä¼šä»¥ asset å½¢å¼å­˜å‚¨èµ·æ¥ã€‚</p></li></ul><h3 id=convenience-api>Convenience API</h3><p>Convenience API é¡¾åæ€ä¹‰æ˜¯å¯¹ CloudKit æ“ä½œçš„ä¾¿åˆ© APIã€‚åˆ©ç”¨ Convenience API å°±å¯ä»¥å¯¹ record è¿›è¡Œæ•°æ®çš„ä¸‰ç§åŸºæœ¬æ“ä½œï¼šå­˜å‚¨ã€è¯»å–ã€æ›´æ”¹ã€‚</p><p>é‚£ä¹ˆï¼Œç»§ç»­å®Œå–„æˆ‘ä»¬çš„ç­¾åˆ°åº”ç”¨å§ï¼å¼€å§‹å‰è®°å¾—åº”ç”¨ CloudKit æ¡†æ¶å¹¶è·å¾—å…¬å¼€æ•°æ®åº“çš„å¼•ç”¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>CloudKit</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> publicDB = CKContainer.defaultContainer().publicCloudDatabase
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#import &lt;CloudKit/CloudKit.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>CKDatabase <span style=color:#f92672>*</span>publicDB <span style=color:#f92672>=</span> [[CKContainer defaultContainer] publicCloudDatabase];
</span></span></code></pre></div><p>ä¸‹é¢ï¼Œæ–°å»ºä¸€ä¸ªä½ç½®ä¿¡æ¯å¹¶å­˜å‚¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> greatID = CKRecordID(recordName: <span style=color:#e6db74>&#34;GreatPlace&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> place = CKRecord(recordType: <span style=color:#e6db74>&#34;Place&#34;</span>, recordID: greatID)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>publicDB.saveRecord(place) { savedRecord, error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// handle errors here</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>CKRecordID <span style=color:#f92672>*</span>greatID <span style=color:#f92672>=</span> [[CKRecordID alloc] initWithRecordName:<span style=color:#e6db74>@&#34;GreatPlace&#34;</span>];
</span></span><span style=display:flex><span>CKRecord <span style=color:#f92672>*</span>place <span style=color:#f92672>=</span> [[CKRecord alloc] initWithRecordType:<span style=color:#e6db74>@&#34;Place&#34;</span> recordID:greatID];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>[publicDB saveRecord:place completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>savedPlace, NSError <span style=color:#f92672>*</span>error) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// handle errors here
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}];
</span></span></code></pre></div><p>å› ä¸º CloudKit åœ¨å¼‚æ­¥è¿è¡Œ <code>saveRecord:completionHandler:</code> æ—¶ä¼šä½¿ç”¨ç½‘ç»œä¸æœåŠ¡å™¨äº¤äº’ï¼Œç½‘ç»œçŠ¶å†µæ˜¯ä¸å®šçš„ï¼Œæ‰€ä»¥ <em>ä¸€å®š</em> è®°å¾—è¦åœ¨ block ä¸­å¤„ç†é”™è¯¯ï¼Œä¸€ä¸ªå¥½çš„åº”ç”¨åº”å½“æœ‰å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚</p><p>ä½ éœ€è¦æ£€æŸ¥ <code>NSError</code> å¯¹è±¡æ¥ç¡®å®šæ­£åœ¨å¤„ç†å“ªç§é”™è¯¯ã€‚ä¾‹å¦‚ï¼Œæ— ç½‘ç»œçº¿è¿æ¥çš„æ—¶å€™ä¼šè§¦å‘ <code>CKErrorNetworkUnavailable</code> ç±»å‹çš„é”™è¯¯ï¼Œç„¶åä½ éœ€è¦åšçš„å°±æ˜¯å¤±è´¥åé‡è¯•ã€‚ç­‰ç­‰ï¼Œé‚£ä¹ˆè¦ä»€ä¹ˆæ—¶å€™é‡è¯•å‘¢ï¼Ÿç«‹åˆ»ï¼Œè¿˜æ˜¯åç§’ä¹‹åï¼Ÿåˆ«æ‹…å¿ƒï¼ŒCloudKit åœ¨ error çš„ <code>userInfo</code> å­—å…¸ä¸­æä¾›äº†ä¸€ä¸ªå»ºè®®çš„é‡è¯•æ—¶é—´ <code>CKErrorRetryAfterKey</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> retryAfterValue = error.userInfo[CKErrorRetryAfterKey] <span style=color:#66d9ef>as</span>? NSTimeInterval {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> retryAfterDate = NSDate(timeIntervalSinceNow: retryAfterValue)
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>double</span> retryAfterValue <span style=color:#f92672>=</span> error.userInfo[CKErrorRetryAfterKey];
</span></span><span style=display:flex><span>NSDate <span style=color:#f92672>*</span>retryAfterDate <span style=color:#f92672>=</span> [NSDate dateWithTimeIntervalSinceNow:retryAfterValue];
</span></span></code></pre></div><p>ä¸‹é¢ï¼Œè·å–ä¸€ä¸ªä½ç½®ä¿¡æ¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> greatID = CKRecordID(recordName: <span style=color:#e6db74>&#34;GreatPlace&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>publicDB.fetchRecordWithID(greatID) { fetchedPlace, error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// handle errors here</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>CKRecordID <span style=color:#f92672>*</span>greatID <span style=color:#f92672>=</span> [[CKRecordID alloc] initWithRecordName:<span style=color:#e6db74>@&#34;GreatPlace&#34;</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>[publicDB fetchRecordWithID:greatID completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>fetchedPlace, NSError <span style=color:#f92672>*</span>error) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// handle errors here
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}];
</span></span></code></pre></div><p>æ›´æ”¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ä½ç½®ä¿¡æ¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> greatID = CKRecordID(recordName: <span style=color:#e6db74>&#34;GreatPlace&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>publicDB.fetchRecordWithID(greatID) { fetchedPlace, error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>guard</span> <span style=color:#66d9ef>let</span> fetchedPlace = fetchedPlace <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// handle errors here</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> name = fetchedPlace[<span style=color:#e6db74>&#34;name&#34;</span>] <span style=color:#66d9ef>as</span>? String ?? <span style=color:#e6db74>&#34;Unnamed Place&#34;</span>
</span></span><span style=display:flex><span>    fetchedPlace[<span style=color:#e6db74>&#34;name&#34;</span>] = name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; Door A&#34;</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>    publicDB.saveRecord(fetchedPlace) { savedPlace, savedError <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>CKRecordID <span style=color:#f92672>*</span>greatID <span style=color:#f92672>=</span> [[CKRecordID alloc] initWithRecordName:<span style=color:#e6db74>@&#34;GreatPlace&#34;</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>[publicDB fetchRecordWithID:greatID completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>fetchedPlace, NSError <span style=color:#f92672>*</span>error) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (fetchedPlace <span style=color:#f92672>!=</span> nil) {
</span></span><span style=display:flex><span>        NSString <span style=color:#f92672>*</span>name <span style=color:#f92672>=</span> fetchedPlace[<span style=color:#e6db74>@&#34;name&#34;</span>];
</span></span><span style=display:flex><span>        fetchedPlace[<span style=color:#e6db74>@&#34;name&#34;</span>] <span style=color:#f92672>=</span> [name stringByAppendingString:<span style=color:#e6db74>@&#34; Door A&#34;</span>];
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        [publicDB saveRecord:fetchedPlace completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>savedPlace, NSError <span style=color:#f92672>*</span>savedError) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }];
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// handle errors here
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}];
</span></span></code></pre></div><p>æ›´æ”¹å·²å­˜åœ¨è®°å½•éå¸¸ç®€å•ï¼Œåªéœ€è¦å°†å…¶è·å–ã€æ›´æ”¹ã€ä¿å­˜å³å¯ã€‚è¿™é‡Œä½ éœ€è¦å…³å¿ƒçš„æ˜¯ <em>å¦‚ä½•</em> ä½œè€…ä¸‰ä¸ªæ­¥éª¤ï¼Œç‰¹åˆ«æ˜¯å½“ä¾èµ–å…¶ä»– record æ¥æ›´æ–°ä¸€ä¸ª record çš„æ—¶å€™ã€‚</p><p>ä¸å¥½çš„å®ç°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>database.fetchRecordWithID(recordID, completionHandler: { record, error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>    database.fetchRecordWithID(otherRecordID, completionHandler: { otherRecord, otherError <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>        database.saveRecord(record!, completionHandler: { anotherRecord, anotherError <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[database fetchRecordWithID:recordID completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>record, NSError <span style=color:#f92672>*</span>error) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		[database fetchRecordWithID:otherRecordID completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>otherRecord, NSError <span style=color:#f92672>*</span>otherError) {
</span></span><span style=display:flex><span>		    <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				[database saveRecord:record completionHandler:<span style=color:#f92672>^</span>(CKRecord <span style=color:#f92672>*</span>anotherRecord, NSError <span style=color:#f92672>*</span>anotherError) {
</span></span><span style=display:flex><span>				    <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				}];
</span></span><span style=display:flex><span>		}];
</span></span><span style=display:flex><span>}];
</span></span></code></pre></div><p>è¿™äº›å¤æ‚çš„åµŒå¥—è¡Œä¸ºå¾ˆå®¹æ˜“è®©ä½ é™·å…¥ä¸¤éš¾ï¼šæœ‰è¶…è¿‡ä¸‰ä¸ªï¼ˆæˆ–è€…æ›´å¤šï¼‰çš„ block å’Œé”™è¯¯è¦å¤„ç†ï¼Œé‚£ä¹ˆè¦åœ¨å“ªä¸€å±‚å¤„ç†å“ªç§é”™è¯¯å‘¢ï¼Œå¦‚æœäº§ç”Ÿäº†é”™è¯¯ï¼Œåº”è¯¥åœ¨å“ªä¸€å±‚ç­‰å¾…åˆ°ä»€ä¹ˆæ—¶å€™é‡è¯•å‘¢ï¼Ÿåœ¨è¿™äº›æ¼äººçš„åµŒå¥—ä¸­å¤„ç†é”™è¯¯å’Œé‡è¯•ï¼Œç®€ç›´å°±æ˜¯ä¸€åœºç¾éš¾ã€‚</p><p>ä¸€ä¸ªæ›´å¥½çš„è§£å†³åŠæ³•æ˜¯ï¼Œä½¿ç”¨ <code>NSOperation</code> çš„ä¾èµ–æ¥ç®¡ç†äº’ç›¸ä¾èµ–çš„ä»»åŠ¡ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> firstFetch = CKFetchRecordsOperation()
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> secondFetch = CKFetchRecordsOperation()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>secondFetch.addDependency(firstFetch)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> queue = NSOperationQueue()
</span></span><span style=display:flex><span>queue.addOperations([firstFetch, secondFetch], waitUntilFinished: <span style=color:#66d9ef>false</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>CKFetchRecordsOperation <span style=color:#f92672>*</span>firstFetch <span style=color:#f92672>=</span> ...;
</span></span><span style=display:flex><span>CKFetchRecordsOperation <span style=color:#f92672>*</span>secondFetch <span style=color:#f92672>=</span> ...;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[secondFetch addDependency:firstFetch];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSOperationQueue <span style=color:#f92672>*</span>queue <span style=color:#f92672>=</span> [[NSOperationQueue alloc] init];
</span></span><span style=display:flex><span>[queue addOperations:[firstFetch, secondFetch] waitUntilFinished: NO];
</span></span></code></pre></div><p>æœ‰äº†è¿™äº›ä¾¿åˆ©çš„ APIï¼Œç›¸ä¿¡ä½ å¯ä»¥åšå¤§éƒ¨åˆ†ä½ æƒ³åšçš„å·¥ä½œäº†ã€‚è¿™æ¯”èµ·å†™åç«¯ä»£ç ã€ç§Ÿç”¨æœåŠ¡å™¨ã€éƒ¨ç½²ç»´æŠ¤ï¼Œç„¶åå†å†™å®¢æˆ·ç«¯ä»£ç å»å’ŒæœåŠ¡ç«¯äº¤æ¢ä¿¡æ¯è¦ç®€å•å¤šäº†ã€‚</p><h2 id=æ›´é«˜çº§çš„åŠŸèƒ½>æ›´é«˜çº§çš„åŠŸèƒ½</h2><h3 id=æŸ¥è¯¢>æŸ¥è¯¢</h3><p>è™½ç„¶è¿™äº›åŠŸèƒ½å·²ç»å¾ˆå¼ºå¤§äº†ï¼Œä½†æˆ‘ä»¬è¦åšä¸€ä¸ªåœ°ç†ä½ç½®ç­¾åˆ°åº”ç”¨ï¼Œä»…éœ€è¦è¿™äº› API æ˜¯ä¸å¤Ÿçš„ã€‚ç°åœ¨æ˜¯æ—¶å€™æ·»åŠ ä¸€ä¸ªèƒ½å¤Ÿæ ¹æ®åœ°ç‚¹åç§°æŸ¥è¯¢åœ°ç‚¹çš„åŠŸèƒ½ï¼Œè¿™å°±éœ€è¦ <em>æŸ¥è¯¢</em> åŠŸèƒ½äº†ã€‚<code>CKQuery</code> å¯¹è±¡ç”± <code>RecordType</code>, <code>NSPredicate</code> å’Œ <code>NSSortDescriptors</code> ç»„æˆã€‚</p><blockquote><p><code>NSPredicate</code> åœ¨è¿™é‡Œæ‰®æ¼”äº†éå¸¸é‡è¦çš„è§’è‰²ï¼Œå®ƒå¯ä»¥è¿›è¡Œå­—ç¬¦ä¸²çš„åŒ¹é…æŸ¥è¯¢ï¼Œæ—¥æœŸçš„æ¯”è¾ƒæŸ¥è¯¢ï¼Œç”šè‡³è¿˜èƒ½è¿›è¡Œåœ°ç†ä½ç½®èŒƒå›´çš„æŸ¥è¯¢ï¼Œä»¥åŠå„ç§ç»„åˆæŸ¥è¯¢ã€‚æ›´ä¸ºè¯¦ç»†çš„æè¿°è§ <a href=https://developer.apple.com/library/ios/documentation/CloudKit/Reference/CKQuery_class/index.html#//apple_ref/occ/cl/CKQuery><code>CKQuery</code> ç›¸å…³çš„æ–‡æ¡£</a></p></blockquote><p>å¦‚æœæˆ‘æƒ³æŸ¥è¯¢åå­—ä¸­å«æœ‰ Apple Store çš„åœ°ç‚¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> predicate = NSPredicate(format: <span style=color:#e6db74>&#34;name CONTAINS &#39;Apple Store&#39;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> query = CKQuery(recordType: <span style=color:#e6db74>&#34;Place&#34;</span>, predicate: predicate)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>publicDB.performQuery(query, inZoneWithID: <span style=color:#66d9ef>nil</span>) { results, error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSPredicate <span style=color:#f92672>*</span>predicate <span style=color:#f92672>=</span> [NSPredicate predicateWithFormat:<span style=color:#e6db74>@&#34;name CONTAINS &#39;Apple Store&#39;&#34;</span>];
</span></span><span style=display:flex><span>CKQuery <span style=color:#f92672>*</span>query <span style=color:#f92672>=</span> [[CKQuery alloc] initWithRecordType:<span style=color:#e6db74>@&#34;Place&#34;</span> predicate:predicate];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>[publicDB performQuery:query
</span></span><span style=display:flex><span>          inZoneWithID:nil
</span></span><span style=display:flex><span>     completionHandler:<span style=color:#f92672>^</span>(NSArray <span style=color:#f92672>*</span>results, NSError <span style=color:#f92672>*</span>error) {
</span></span><span style=display:flex><span>         <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>     }];
</span></span></code></pre></div><p>æˆ‘è§‰å¾—æ ¹æ®è¿™ä¸ªä¾‹å­ï¼Œä½ èƒ½å¤Ÿå¾ˆå®¹æ˜“è‡ªå·±å†™å‡ºæ ¹æ®ç”¨æˆ·å½“å‰çš„åœ°ç†ä½ç½®æŸ¥è¯¢è·ç¦»ä¸º 1 å…¬é‡Œå†…æ‰€æœ‰åœ°ç‚¹çš„åˆ—è¡¨ã€‚</p><h3 id=è®¢é˜…é€šçŸ¥>è®¢é˜…é€šçŸ¥</h3><p>æœ‰äº†ä»¥ä¸Šçš„åŠŸèƒ½æˆ‘ç¡®ä¿¡ä½ å¯ä»¥æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„åº”ç”¨äº†ï¼Œä½†æ˜¯ä¸æ˜¯è¿˜ç¼ºäº†ç‚¹ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¯¹äº†ï¼Œæ¨é€é€šçŸ¥ã€‚æ¨é€å¯¹äºä¸€ä¸ªç­¾åˆ°åº”ç”¨å¤ªé‡è¦äº†ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªç¤¾äº¤è¾¾äººå¯èƒ½æƒ³è¦è¿™æ ·çš„åŠŸèƒ½ï¼šå¦‚æœæŸä¸ªç­¾åˆ°çš„æè¿°ä¸­æåˆ°äº† party çš„å­—æ ·ï¼Œé‚£ä¹ˆå°±ç»™ä»–å‘é€æ¨é€é€šçŸ¥å‘Šè¯‰ä»–æœ‰äººç­¾åˆ°äº†ä¸€ä¸ª partyã€‚CloudKit æ¡†æ¶ä¸­é€šè¿‡ <code>CKSubscription</code> ç±»è®©è¿™ä¸€åˆ‡å˜ä¸ºäº†å¯èƒ½ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> predicate = NSPredicate(format: <span style=color:#e6db74>&#34;description CONTAINS &#39;party&#39;&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> subscription = CKSubscription(recordType: <span style=color:#e6db74>&#34;Checkin&#34;</span>, predicate: predicate, options: .FiresOnRecordCreation)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> info = CKNotificationInfo()
</span></span><span style=display:flex><span>info.alertLocalizationKey = <span style=color:#e6db74>&#34;NEW_PARTY_ALERT_KEY&#34;</span>
</span></span><span style=display:flex><span>info.soundName = <span style=color:#e6db74>&#34;NewAlert.aiff&#34;</span>
</span></span><span style=display:flex><span>info.shouldBadge = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>subscription.notificationInfo = info
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>publicDB.saveSubscription(subscription) { subscription, error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>CKDatabase <span style=color:#f92672>*</span>publicDB <span style=color:#f92672>=</span> [[CKContainer defaultContainer] publicCloudDatabase];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>NSPredicate <span style=color:#f92672>*</span>predicate <span style=color:#f92672>=</span> [NSPredicate predicateWithFormat:<span style=color:#e6db74>@&#34;description CONTAINS &#39;party&#39;&#34;</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>CKSubscription <span style=color:#f92672>*</span>subscription <span style=color:#f92672>=</span> [[CKSubscription alloc] initWithRecordType:<span style=color:#e6db74>@&#34;Checkin&#34;</span> predicate:predicate options:CKSubscriptionOptionsFiresOnRecordCreation];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>CKNotificationInfo <span style=color:#f92672>*</span>info <span style=color:#f92672>=</span> [CKNotificationInfo new];
</span></span><span style=display:flex><span>info.alertLocalizationKey <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;NEW_PARTY_ALERT_KEY&#34;</span>;
</span></span><span style=display:flex><span>info.soundName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;NewAlert.aiff&#34;</span>;
</span></span><span style=display:flex><span>info.shouldBadge <span style=color:#f92672>=</span> YES;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>subscription.notificationInfo <span style=color:#f92672>=</span> info;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>[publicDB saveSubscription:subscription
</span></span><span style=display:flex><span>         completionHandler:<span style=color:#f92672>^</span>(CKSubscription <span style=color:#f92672>*</span>subscription, NSError <span style=color:#f92672>*</span>error) {
</span></span><span style=display:flex><span>             <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>         }];
</span></span></code></pre></div><p>æ”¶åˆ°æ¨é€é€šçŸ¥æ—¶ï¼Œåœ¨ app delegate ä¸­å¤„ç†ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>application</span>(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> ckNotification = CKNotification(fromRemoteNotificationDictionary: userInfo <span style=color:#66d9ef>as</span>! [String : NSObject])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ckNotification.notificationType == .Query,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> queryNotification = ckNotification <span style=color:#66d9ef>as</span>? CKQueryNotification
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> recordID = queryNotification.recordID
</span></span><span style=display:flex><span>        <span style=color:#75715e>//...</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>application:</span>(UIApplication <span style=color:#f92672>*</span>)application <span style=color:#a6e22e>didReceiveRemoteNotification:</span>(NSDictionary <span style=color:#f92672>*</span>)userInfo{
</span></span><span style=display:flex><span>    CKNotification <span style=color:#f92672>*</span>ckNotification <span style=color:#f92672>=</span> [CKNotification notificationFromRemoteNotificationDictionary:userInfo];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (ckNotification.notificationType <span style=color:#f92672>==</span> CKNotificationTypeQuery) {
</span></span><span style=display:flex><span>        CKQueryNotification <span style=color:#f92672>*</span>queryNotification <span style=color:#f92672>=</span> ckNotification;
</span></span><span style=display:flex><span>        CKRecordID <span style=color:#f92672>*</span>recordID <span style=color:#f92672>=</span> [queryNotification recordID];
</span></span><span style=display:flex><span>        <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=è¿œä¸æ­¢å¦‚æ­¤>è¿œä¸æ­¢å¦‚æ­¤</h2><p>æ­£å¦‚æˆ‘ä»¬å¼€å§‹æ‰€æåˆ°çš„ï¼ŒCloudKit èƒ½åšçš„è¿˜è¿œä¸æ­¢å¦‚æ­¤ã€‚ä½ å¯ä»¥ä¸ºç­¾åˆ°é™„ä¸Šå›¾ç‰‡ï¼›å¯¹ Checkin å’Œ Place ä¹‹é—´å»ºç«‹ reference å…³è”ä»¥ä¾¿èƒ½å¤ŸæŸ¥è¯¢æŸä¸ªåœ°ç‚¹ä¸‹çš„æ‰€æœ‰ç­¾åˆ°ï¼›ç”šè‡³ï¼ŒCloudKit è¿˜æä¾›äº† API ä¾›ä½ éå¸¸æ–¹ä¾¿åœ°æŸ¥è¯¢ä½ é€šè®¯å½•ä¸­çš„å¥½å‹è¿˜æœ‰è°ä¹Ÿåœ¨ç©è¿™ä¸ªåº”ç”¨&mldr;&mldr;</p><p>ç­‰ä¸åŠè¦è¯•è¯• CloudKit äº†ï¼Ÿå®ƒèƒ½è®©ä½ ä»ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€ç›‘æ§æœåŠ¡å™¨å‹åŠ›ã€é•¿æœŸç»´æŠ¤å¤§é‡çš„ CDNã€ç§Ÿç”¨æœåŠ¡å™¨ç­‰ç­‰ç­‰ç­‰çš„äº‹æƒ…ä¸­è§£è„±å‡ºæ¥ã€‚ç­‰ç­‰ï¼CloudKit æ€ä¹ˆæ”¶è´¹å‘¢ï¼Œä¼šå¾ˆè´µå—ï¼Ÿç­”æ¡ˆæ˜¯ï¼šå…è´¹ã€‚ç›®å‰è‹¹æœå…è®¸ä½ ä½¿ç”¨ CloudKit å­˜å‚¨ 10 GB èµ„æºï¼Œ100 M æ•°æ®åº“å­˜å‚¨ï¼Œæ¯å¤© 2 GB æµé‡ï¼›å½“ä½ çš„ç”¨æˆ·æ•°é‡å¢åŠ çš„æ—¶å€™ï¼Œè¿™äº›å…è´¹é¢åº¦ä¹Ÿç›¸åº”åœ°å¢åŠ åˆ° 1 PB å­˜å‚¨ã€10 TB æ•°æ®åº“å­˜å‚¨ï¼Œä»¥åŠæ¯å¤© 200 TB æµé‡ã€‚</p><blockquote><p>å‚è§ <a href=https://developer.apple.com/icloud/index.html>CloudKit cost calculator</a> é¡µé¢åº•éƒ¨æ¥äº†è§£è¯¦ç»†çš„å…è´¹é¢åº¦å’Œæ”¶è´¹æ ‡å‡†ã€‚</p></blockquote><hr><p>WWDC 2015 ä¸­æåˆ°ï¼ŒCloudKit å·²ç» <em>ä¸ä»…</em> å¯ä»¥åœ¨ iOS å’Œ OS X ä¸Šä½¿ç”¨ï¼Œå¯ä»¥åœ¨ä½ çš„ç½‘ç«™ä¸Šé›†æˆ <a href=https://developer.apple.com/library/prerelease/ios/documentation/CloudKitJS/Reference/CloudKitJavaScriptReference/index.html>CloudKit JS</a>ï¼Œä»¥ä¾¿ iCloud ç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä¹Ÿèƒ½ä½¿ç”¨ç›¸åº”çš„åŠŸèƒ½ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨ <a href=https://developer.apple.com/library/prerelease/ios/documentation/DataManagement/Conceptual/CloutKitWebServicesReference/Introduction/Introduction.html>CloudKit web service</a> å¯¹ CloudKit æœåŠ¡ç«¯ç›´æ¥è¿›è¡Œ HTTP è¯·æ±‚ã€‚è¿™æ„å‘³ç€ï¼Œç°åœ¨å…¶ä»–ç§»åŠ¨æˆ–æ¡Œé¢å¹³å°éƒ½å¯ä»¥ä½¿ç”¨ CloudKit äº†ï¼</p><p>CloudKit å¦‚æ­¤è¿·äººï¼Œæˆ‘å·²ç»ç­‰ä¸åŠçœ‹çœ‹ NSHipster ä»¬èƒ½å¤Ÿç”¨å®ƒåšå‡ºä»€ä¹ˆä»¤äººæƒŠå¹çš„åº”ç”¨äº†ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2015-06-29 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Croath Liu ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Cocoa target=_blank>Cocoa</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>