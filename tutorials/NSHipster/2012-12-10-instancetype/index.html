<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>instancetype</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="instancetype,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="instancetype,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>instancetype</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>JJ Mao</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>æƒ³çŸ¥é“Objective-Cæ¥ä¸‹å»ä¼šå‘ç”Ÿä»€ä¹ˆå—ï¼Ÿ<a href=http://clang.llvm.org/docs/LanguageExtensions.html>è¯·å¤šå…³æ³¨Objective-Cæœ€æ–°åŠ¨å‘</a>ã€‚</p><p>Objective-C æ˜¯ä¸€é—¨æ­£è¿…é€Ÿå‘å±•çš„è¯­è¨€ï¼Œè¿™ç§å‘å±•é€Ÿåº¦åœ¨åˆ«çš„ç°æœ‰è¯­è¨€ä¸­æ˜¯ä¸æ›¾æœ‰è¿‡çš„ã€‚ARCï¼Œobject literalsï¼Œsubscriptingï¼Œblocksï¼šåœ¨çŸ­çŸ­çš„ä¸‰å¹´æ—¶é—´é‡Œï¼ŒObjective-Cç¼–ç¨‹çš„è®¸å¤šæ–¹å¼å‘ç”Ÿäº†æ”¹å˜ï¼ˆå˜å¾—æ›´å¥½ï¼‰ã€‚</p><p>è¿™ä¸€åˆ‡çš„åˆ›æ–°éƒ½æ˜¯Appleå‚ç›´æ•´åˆçš„æˆæœã€‚æ­£å¦‚Appleåœ¨è®¾è®¡<a href=https://en.wikipedia.org/wiki/Apple_A4>è‡ªä¸»ç ”å‘èŠ¯ç‰‡</a>ä¸­çš„æŠ•èµ„ä¸€æ ·ï¼Œåˆ©ç”¨æ æ†ä½œç”¨ä¸æ‰‹æœºç¡¬ä»¶å±•å¼€æ¿€çƒˆçš„ç«äº‰ã€‚åœ¨<a href=http://llvm.org>LLVM</a> ä¸Šçš„æŠ•èµ„ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä½¿è½¯ä»¶è·Ÿä¸Šä¸šç•Œæœ€æ–°æ­¥ä¼ã€‚</p><p>Clangä»æ™®é€šåˆ°èŒƒä¾‹è½¬å˜çš„å‘å±•ï¼ŒçœŸè¦è¯´æ¸…å®ƒä»¬ä¹‹é—´çš„å·®å¼‚è¿˜å¾—æ…¢æ…¢æ¥ã€‚å› ä¸ºæˆ‘ä»¬æ­£åœ¨è®¨è®ºçš„æ˜¯åº•å±‚è¯­è¨€çš„ç‰¹æ€§ï¼Œå¯¹äºAPIè®¾è®¡çš„æ›´æ·±å±‚å«ä¹‰è¿˜æ¯”è¾ƒéš¾ç†è§£ã€‚</p><p>å…¶ä¸­ä¸€ä¸ªä¾‹å­å°±æ˜¯ <code>instancetype</code> ï¼Œè¿™ä¹Ÿæ˜¯æœ¬å‘¨æ–‡ç« çš„ä¸»é¢˜ã€‚</p><hr><p>Objective-Cçš„ä¸€äº›ä½¿ç”¨æƒ¯ä¾‹ä¸ä»…ä»…æ˜¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œæ›´æ˜¯ç»™ç¼–è¯‘å™¨çš„éšè—æŒ‡ä»¤ã€‚</p><p>ä¾‹å¦‚ï¼Œ <code>alloc</code> å’Œ <code>init</code> çš„è¿”å›ç±»å‹éƒ½æ˜¯ <code>id</code> ï¼Œç„¶è€Œåœ¨Xcodeä¸­ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥æ‰€æœ‰æ­£ç¡®ç±»å‹ã€‚å®ƒæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ</p><p>åœ¨Cocoaä¸­ï¼Œçº¦å®š <code>alloc</code> æˆ– <code>init</code> çš„æ–¹æ³•æ€»æ˜¯è¿”å›æ¥æ”¶å™¨ç±»å®ä¾‹çš„å¯¹è±¡ã€‚æ®è¯´è¿™äº›æ–¹æ³•æœ‰ä¸€ä¸ª<strong>ç›¸å…³è¿”å›ç±»å‹</strong>ã€‚</p><p>è™½ç„¶ç±»æ„é€ æ–¹æ³•ä¹Ÿæ˜¯è¿”å› <code>id</code> ï¼Œä½†æ˜¯ç±»æ„é€ æ–¹æ³•å¹¶æ²¡æœ‰åšåŒæ ·çš„ç±»å‹æ£€æŸ¥ï¼Œå› ä¸ºå®ƒä»¬ä¸éµå¾ªå‘½åè§„èŒƒã€‚</p><p>ä½ å¯ä»¥è‡ªå·±è¯•ç€è¿™æ ·ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[[[NSArray alloc] init] mediaPlaybackAllowsAirPlay]; <span style=color:#75715e>// â— &#34;No visible @interface for `NSArray` declares the selector `mediaPlaybackAllowsAirPlay`&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>[[NSArray array] mediaPlaybackAllowsAirPlay]; <span style=color:#75715e>// (No error)
</span></span></span></code></pre></div><p>ç”±äº <code>alloc</code> å’Œ <code>init</code> ä½œä¸ºç›¸å…³è¿”å›ç±»å‹éµå¾ªå‘½åè§„èŒƒï¼Œæ‰§è¡Œå¯¹ <code>NSArray</code> çš„æ­£ç¡®ç±»å‹æ£€æŸ¥ã€‚ç„¶è€Œï¼Œç­‰ä»·ç±»æ„é€ å‡½æ•° <code>array</code> ä¸éµå¾ªå‘½åè§„èŒƒï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯ <code>id</code> ç±»å‹ã€‚</p><p><code>id</code> ç±»å‹å¯¹äºç¦ç”¨ç±»å‹å®‰å…¨æ€§æ£€æŸ¥éå¸¸æœ‰ç”¨ï¼Œä½†å½“ä½  <em>ç¡®å®</em> éœ€è¦å®ƒçš„æ—¶å€™å´æ²¡æœ‰æ—¶ï¼Œæƒ…å†µä¼šå˜å¾—éå¸¸ç³Ÿç³•ã€‚</p><p>å¦ä¸€ç§æ˜¾ç¤ºå£°æ˜è¿”å›ç±»å‹ï¼ˆåœ¨ä¹‹å‰ä¾‹å­ä¸­çš„ <code>(NSArray *)</code>ï¼‰çš„æ–¹å¼æœ‰äº†ç¨å¾®çš„æ”¹è¿›ï¼Œä½†æ˜¯å®ƒä¸åˆ©äºå­ç±»çš„å‘æŒ¥ã€‚</p><p>æ‰€ä»¥ç¼–è¯‘å™¨ä»è¿™é‡Œä»‹å…¥ä»¥è§£å†³Objective-Cç±»å‹ç³»ç»Ÿçš„è¿™ä¸ªæ°¸æ’è¾¹ç•Œæƒ…å†µï¼š</p><p><code>instancetype</code> å…³é”®å­—ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸€ä¸ªæ–¹æ³•çš„ç›¸å…³è¿”å›ç±»å‹ã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span>+ (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>personWithName:</span>(NSString <span style=color:#f92672>*</span>)name;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><blockquote><p><code>instancetype</code> ä¸ <code>id</code> ä¸ä¸€æ ·, <code>instancetype</code> åªèƒ½åœ¨æ–¹æ³•å£°æ˜ä¸­ä½œä¸ºè¿”å›ç±»å‹ä½¿ç”¨ã€‚</p></blockquote><p>ä½¿ç”¨ <code>instancetype</code> ï¼Œç¼–è¯‘å™¨å°†æ­£ç¡®çš„æ¨æ–­å‡º <code>+personWithName:</code> æ˜¯ <code>Person</code> çš„ä¸€ä¸ªå®ä¾‹ã€‚</p><p>ä¸ºäº†åœ¨ä¸ä¹…çš„å°†æ¥ä½¿ç”¨ <code>instancetype</code> ï¼Œä½ å¯ä»¥åœ¨Foundationä¸­æŸ¥æ‰¾ç±»æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚<a href=https://developer.apple.com/library/ios/#documentation/uikit/reference/UICollectionViewLayoutAttributes_class/Reference/Reference.html>UICollectionViewLayoutAttributes</a> å°±å·²ç»æ­£åœ¨ä½¿ç”¨ <code>instancetype</code> äº†ã€‚</p><h2 id=æ·±å±‚å«ä¹‰>æ·±å±‚å«ä¹‰</h2><p>è¯­è¨€ç‰¹æ€§ååˆ†æœ‰è¶£ï¼Œå› ä¸ºå®ƒåœ¨é«˜çº§è½¯ä»¶è®¾è®¡æ–¹é¢çš„çš„å½±å“å¾€å¾€æ˜¯æ¨¡ç³Šçš„ã€‚</p><p>ç„¶è€Œ <code>instancetype</code> çœ‹ä¼¼æ™®é€šï¼Œå°½ç®¡å®ƒèƒ½ä¸ºç¼–è¯‘å™¨é”¦ä¸Šæ·»èŠ±ï¼Œä½†å®ƒå¯ç”¨äºæ›´æ£’çš„ç»“æœã€‚</p><p><a href=https://twitter.com/jonsterling>Jonathan Sterling</a> å†™äº†<a href=http://www.jonmsterling.com/posts/2012-02-05-typed-collections-with-self-types-in-objective-c.html>è¿™ç¯‡ååˆ†æœ‰è¶£çš„æ–‡ç« </a>, æ–‡ç« ä¸­è¯¦ç»†æè¿°äº† <code>instancetype</code> åœ¨æ²¡æœ‰<a href=https://en.wikipedia.org/wiki/Generic_programming>æ³›å‹</a>çš„æƒ…å†µä¸‹æ˜¯å¦‚ä½•ç”¨äºé™æ€ç±»å‹collectionsç¼–ç çš„:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSURL <span style=color:#f92672>&lt;</span>MapCollection<span style=color:#f92672>&gt;</span> <span style=color:#f92672>*</span>sites <span style=color:#f92672>=</span> (<span style=color:#66d9ef>id</span>)[NSURL mapCollection];
</span></span><span style=display:flex><span>[sites put:[NSURL URLWithString:<span style=color:#e6db74>@&#34;http://www.jonmsterling.com/&#34;</span>]
</span></span><span style=display:flex><span>        at:<span style=color:#e6db74>@&#34;jon&#34;</span>];
</span></span><span style=display:flex><span>[sites put:[NSURL URLWithString:<span style=color:#e6db74>@&#34;http://www.nshipster.com/&#34;</span>]
</span></span><span style=display:flex><span>        at:<span style=color:#e6db74>@&#34;nshipster&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSURL <span style=color:#f92672>*</span>jonsSite <span style=color:#f92672>=</span> [sites at:<span style=color:#e6db74>@&#34;jon&#34;</span>]; <span style=color:#75715e>// =&gt; http://www.jonmsterling.com/
</span></span></span></code></pre></div><p>é™æ€ç±»å‹collectionsä¼šä½¿APIsæ›´å¯Œæœ‰è¡¨ç°åŠ›&ndash;å¼€å‘è€…å¯ä»¥ç¡®å®šä¸€ä¸ªcollectionå‚æ•°ä¸­å…è®¸ä½¿ç”¨çš„å¯¹è±¡ç±»å‹ã€‚</p><p>ä¸è®ºè¿™æ˜¯å¦èƒ½åœ¨Objective-Cä¸­æˆä¸ºå…¬è®¤çš„è§„èŒƒï¼Œæ›´ä»¤äººç€è¿·çš„æ˜¯åƒ <code>instancetype</code> è¿™æ ·çš„åº•å±‚ç‰¹æ€§æ˜¯å¦‚ä½•ç”¨äºæ”¹å˜è¯­è¨€è½®å»“çš„(åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿å…¶çœ‹ä¼¼æ›´åƒ<a href=https://en.wikipedia.org/wiki/C_Sharp_(programming_language)>C#</a>ï¼‰ã€‚</p><hr><p><code>instancetype</code> åªæ˜¯ä¼—å¤šè¯­è¨€ä¹‹ä¸­çš„ä¸€ç§å¯¹Objective-Cçš„æ‰©å±•ï¼Œä½¿å®ƒæ›´å¤šçš„è¢«æ·»åŠ åˆ°æ¯ä¸ªæ–°ç‰ˆæœ¬ä¸­ã€‚</p><p>è®¤è¯†å®ƒå¹¶çˆ±ä¸Šå®ƒã€‚</p><p>ä»¥æ­¤ä½œä¸ºå¦‚ä½•å…³æ³¨åº•å±‚ç»†èŠ‚çš„ä¾‹å­ï¼Œå°†ç»™ä½ å¸¦æ¥å…¨æ–°çš„è§†è§’ä»¥å¼ºæœ‰åŠ›çš„æ–¹å¼å»æ”¹å˜Objective-Cã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2012-12-10 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Objective-C target=_blank>Objective-C</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>