<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>NSURLCache</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="NSURLCache,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="NSURLCache,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>NSURLCache</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>Ricky Tan</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p><code>NSURLCache</code> ä¸ºæ‚¨çš„åº”ç”¨çš„ URL è¯·æ±‚æä¾›äº†å†…å­˜ä¸­ä»¥åŠç£ç›˜ä¸Šçš„ç»¼åˆç¼“å­˜æœºåˆ¶ã€‚ ä½œä¸ºåŸºç¡€ç±»åº“ <a href=https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html%23//apple_ref/doc/uid/10000165i>URL åŠ è½½ç³»ç»Ÿ</a> çš„ä¸€éƒ¨åˆ†ï¼Œä»»ä½•é€šè¿‡ <code>NSURLConnection</code> åŠ è½½çš„è¯·æ±‚éƒ½å°†è¢« <code>NSURLCache</code> å¤„ç†ã€‚</p><p>ç½‘ç»œç¼“å­˜å‡å°‘äº†éœ€è¦å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ¬¡æ•°ï¼ŒåŒæ—¶ä¹Ÿæå‡äº†ç¦»çº¿æˆ–åœ¨ä½é€Ÿç½‘ç»œä¸­ä½¿ç”¨åº”ç”¨çš„ä½“éªŒã€‚</p><p>å½“ä¸€ä¸ªè¯·æ±‚å®Œæˆä¸‹è½½æ¥è‡ªæœåŠ¡å™¨çš„å›åº”ï¼Œä¸€ä¸ªç¼“å­˜çš„å›åº”å°†åœ¨æœ¬åœ°ä¿å­˜ã€‚ä¸‹ä¸€æ¬¡åŒä¸€ä¸ªè¯·æ±‚å†å‘èµ·æ—¶ï¼Œæœ¬åœ°ä¿å­˜çš„å›åº”å°±ä¼šé©¬ä¸Šè¿”å›ï¼Œä¸éœ€è¦è¿æ¥æœåŠ¡å™¨ã€‚<code>NSURLCache</code> ä¼š <em>è‡ªåŠ¨</em> ä¸” <em>é€æ˜</em> åœ°è¿”å›å›åº”ã€‚</p><p>ä¸ºäº†å¥½å¥½åˆ©ç”¨ <code>NSURLCache</code>ï¼Œä½ éœ€è¦åˆå§‹åŒ–å¹¶è®¾ç½®ä¸€ä¸ªå…±äº«çš„ URL ç¼“å­˜ã€‚åœ¨ iOS ä¸­è¿™é¡¹å·¥ä½œéœ€è¦åœ¨ <code>-application:didFinishLaunchingWithOptions:</code> å®Œæˆï¼Œè€Œ OS X ä¸­æ˜¯åœ¨ <code>â€“applicationDidFinishLaunching:</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>- (<span style=color:#66d9ef>BOOL</span>)<span style=color:#a6e22e>application:</span>(UIApplication <span style=color:#f92672>*</span>)application
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>didFinishLaunchingWithOptions:</span>(NSDictionary <span style=color:#f92672>*</span>)launchOptions
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  NSURLCache <span style=color:#f92672>*</span>URLCache <span style=color:#f92672>=</span> [[NSURLCache alloc] initWithMemoryCapacity:<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span>
</span></span><span style=display:flex><span>                                                       diskCapacity:<span style=color:#ae81ff>20</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span>
</span></span><span style=display:flex><span>                                                           diskPath:nil];
</span></span><span style=display:flex><span>  [NSURLCache setSharedURLCache:URLCache];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ç¼“å­˜ç­–ç•¥ç”±è¯·æ±‚ï¼ˆå®¢æˆ·ç«¯ï¼‰å’Œå›åº”ï¼ˆæœåŠ¡ç«¯ï¼‰åˆ†åˆ«æŒ‡å®šã€‚ç†è§£è¿™äº›ç­–ç•¥ä»¥åŠå®ƒä»¬å¦‚ä½•ç›¸äº’å½±å“ï¼Œæ˜¯ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºæ‰¾åˆ°æœ€ä½³è¡Œä¸ºçš„å…³é”®ã€‚</p><h2 id=nsurlrequestcachepolicy><code>NSURLRequestCachePolicy</code></h2><p><code>NSURLRequest</code> æœ‰ä¸ª <code>cachePolicy</code> å±æ€§ï¼Œå®ƒæ ¹æ®ä»¥ä¸‹å¸¸é‡æŒ‡å®šäº†è¯·æ±‚çš„ç¼“å­˜è¡Œä¸ºï¼š</p><ul><li><code>NSURLRequestUseProtocolCachePolicy</code>ï¼š å¯¹ç‰¹å®šçš„ URL è¯·æ±‚ä½¿ç”¨ç½‘ç»œåè®®ä¸­å®ç°çš„ç¼“å­˜é€»è¾‘ã€‚è¿™æ˜¯é»˜è®¤çš„ç­–ç•¥ã€‚</li><li><code>NSURLRequestReloadIgnoringLocalCacheData</code>ï¼šæ•°æ®éœ€è¦ä»åŸå§‹åœ°å€åŠ è½½ã€‚ä¸ä½¿ç”¨ç°æœ‰ç¼“å­˜ã€‚</li><li><code>NSURLRequestReloadIgnoringLocalAndRemoteCacheData</code>ï¼šä¸ä»…å¿½ç•¥æœ¬åœ°ç¼“å­˜ï¼ŒåŒæ—¶ä¹Ÿå¿½ç•¥ä»£ç†æœåŠ¡å™¨æˆ–å…¶ä»–ä¸­é—´ä»‹è´¨ç›®å‰å·²æœ‰çš„ã€åè®®å…è®¸çš„ç¼“å­˜ã€‚</li><li><code>NSURLRequestReturnCacheDataElseLoad</code>ï¼šæ— è®ºç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Œå…ˆä½¿ç”¨æœ¬åœ°ç¼“å­˜æ•°æ®ã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰è¯·æ±‚æ‰€å¯¹åº”çš„æ•°æ®ï¼Œé‚£ä¹ˆä»åŸå§‹åœ°å€åŠ è½½æ•°æ®ã€‚</li><li><code>NSURLRequestReturnCacheDataDontLoad</code>ï¼šæ— è®ºç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Œå…ˆä½¿ç”¨æœ¬åœ°ç¼“å­˜æ•°æ®ã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰è¯·æ±‚æ‰€å¯¹åº”çš„æ•°æ®ï¼Œé‚£ä¹ˆæ”¾å¼ƒä»åŸå§‹åœ°å€åŠ è½½æ•°æ®ï¼Œè¯·æ±‚è§†ä¸ºå¤±è´¥ï¼ˆå³ï¼šâ€œç¦»çº¿â€æ¨¡å¼ï¼‰ã€‚</li><li><code>NSURLRequestReloadRevalidatingCacheData</code>ï¼šä»åŸå§‹åœ°å€ç¡®è®¤ç¼“å­˜æ•°æ®çš„åˆæ³•æ€§åï¼Œç¼“å­˜æ•°æ®å°±å¯ä»¥ä½¿ç”¨ï¼Œå¦åˆ™ä»åŸå§‹åœ°å€åŠ è½½ã€‚</li></ul><p>ä½ å¹¶ä¸ä¼šæƒŠå¥‡äºè¿™äº›å€¼ä¸è¢«é€å½»ç†è§£ä¸”ç»å¸¸ææ··æ·†ã€‚</p><p><code>NSURLRequestReloadIgnoringLocalAndRemoteCacheData</code> å’Œ <code>NSURLRequestReloadRevalidatingCacheData</code> <a href=https://gist.github.com/mattt/4753073#file-nsurlrequest-h-L95-L108><em>æ ¹æœ¬æ²¡æœ‰å®ç°</em></a>ï¼ˆ<a href="http://openradar.appspot.com/radar?id=1755401">Link to Radar</a>ï¼‰æ›´åŠ åŠ æ·±äº†æ··ä¹±ç¨‹åº¦ï¼</p><p>å…³äº<code>NSURLRequestCachePolicy</code>ï¼Œä»¥ä¸‹æ‰æ˜¯ä½  <em>å®é™…</em> éœ€è¦äº†è§£çš„ä¸œè¥¿ï¼š</p><table><thead><tr><th>å¸¸é‡</th><th>æ„ä¹‰</th></tr></thead><tbody><tr><td><tt>UseProtocolCachePolicy</tt></td><td>é»˜è®¤è¡Œä¸º</td></tr><tr><td><tt>ReloadIgnoringLocalCacheData</tt></td><td>ä¸ä½¿ç”¨ç¼“å­˜</td></tr><tr><td><del><tt>ReloadIgnoringLocalAndRemoteCacheData</tt></del></td><td><del>æˆ‘æ˜¯è®¤çœŸåœ°ï¼Œä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜</del></td></tr><tr><td><tt>ReturnCacheDataElseLoad</tt></td><td>ä½¿ç”¨ç¼“å­˜ï¼ˆä¸ç®¡å®ƒæ˜¯å¦è¿‡æœŸï¼‰ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œé‚£ä»ç½‘ç»œåŠ è½½å§</td></tr><tr><td><tt>ReturnCacheDataDontLoad</tt></td><td>ç¦»çº¿æ¨¡å¼ï¼šä½¿ç”¨ç¼“å­˜ï¼ˆä¸ç®¡å®ƒæ˜¯å¦è¿‡æœŸï¼‰ï¼Œä½†æ˜¯<em>ä¸</em>ä»ç½‘ç»œåŠ è½½</td></tr><tr><td><del><tt>ReloadRevalidatingCacheData</tt></del></td><td><del>åœ¨ä½¿ç”¨å‰å»æœåŠ¡å™¨éªŒè¯</del></td></tr></tbody></table><h2 id=http-ç¼“å­˜è¯­ä¹‰>HTTP ç¼“å­˜è¯­ä¹‰</h2><p>å› ä¸º <code>NSURLConnection</code> è¢«è®¾è®¡æˆæ”¯æŒå¤šç§åè®®â€”â€”åŒ…æ‹¬ <code>FTP</code>ã€<code>HTTP</code>ã€<code>HTTPS</code>â€”â€”æ‰€ä»¥ URL åŠ è½½ç³»ç»Ÿç”¨ä¸€ç§åè®®æ— å…³çš„æ–¹å¼æŒ‡å®šç¼“å­˜ã€‚ä¸ºäº†æœ¬æ–‡çš„ç›®çš„ï¼Œç¼“å­˜ç”¨æœ¯è¯­ HTTP è¯­ä¹‰æ¥è§£é‡Šã€‚</p><p>HTTP è¯·æ±‚å’Œå›åº”ç”¨ <a href=http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html>headers</a> æ¥äº¤æ¢å…ƒæ•°æ®ï¼Œå¦‚å­—ç¬¦ç¼–ç ã€MIME ç±»å‹å’Œç¼“å­˜æŒ‡ä»¤ç­‰ã€‚</p><h3 id=request-cache-headers>Request Cache Headers</h3><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>NSURLRequest</code> ä¼šç”¨å½“å‰æ—¶é—´å†³å®šæ˜¯å¦è¿”å›ç¼“å­˜çš„æ•°æ®ã€‚ä¸ºäº†æ›´ç²¾ç¡®åœ°æ§åˆ¶ï¼Œå…è®¸ä½¿ç”¨ä»¥ä¸‹è¯·æ±‚å¤´ï¼š</p><ul><li><code>If-Modified-Since</code> - è¿™ä¸ªè¯·æ±‚å¤´ä¸ <code>Last-Modified</code> å›åº”å¤´ç›¸å¯¹åº”ã€‚æŠŠè¿™ä¸ªå€¼è®¾ä¸ºåŒä¸€ç»ˆç«¯æœ€åä¸€æ¬¡è¯·æ±‚æ—¶è¿”å›çš„ <code>Last-Modified</code> å­—æ®µçš„å€¼ã€‚</li><li><code>If-None-Match</code> - è¿™ä¸ªè¯·æ±‚å¤´ä¸ <code>Etag</code> å›åº”å¤´ç›¸å¯¹åº”ã€‚ä½¿ç”¨åŒä¸€ç»ˆç«¯æœ€åä¸€æ¬¡è¯·æ±‚çš„ <code>Etag</code> å€¼ã€‚</li></ul><h3 id=response-cache-headers>Response Cache Headers</h3><p><code>NSHTTPURLResponse</code> åŒ…å«å¤šä¸ª HTTP å¤´ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ä»¥ä¸‹æŒ‡ä»¤æ¥è¯´æ˜å›åº”åº”å½“å¦‚ä½•ç¼“å­˜ï¼š</p><ul><li><code>Cache-Control</code> - è¿™ä¸ªå¤´å¿…é¡»ç”±æœåŠ¡å™¨ç«¯æŒ‡å®šä»¥å¼€å¯å®¢æˆ·ç«¯çš„ HTTP ç¼“å­˜åŠŸèƒ½ã€‚è¿™ä¸ªå¤´çš„å€¼å¯èƒ½åŒ…å« <code>max-age</code>ï¼ˆç¼“å­˜å¤šä¹…ï¼‰ï¼Œæ˜¯å…¬å…± <code>public</code> è¿˜æ˜¯ç§æœ‰ <code>private</code>ï¼Œæˆ–è€…ä¸ç¼“å­˜ <code>no-cache</code> ç­‰ä¿¡æ¯ã€‚è¯¦æƒ…è¯·å‚é˜… <a href=http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9><code>Cache-Control</code> section of RFC 2616</a>ã€‚</li></ul><p>é™¤äº† <code>Cache-Control</code> ä»¥å¤–ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯èƒ½å‘é€ä¸€äº›é™„åŠ çš„å¤´ç”¨äºæ ¹æ®éœ€è¦æœ‰æ¡ä»¶åœ°è¯·æ±‚ï¼ˆå¦‚ä¸Šä¸€èŠ‚æ‰€æåˆ°çš„ï¼‰ï¼š</p><ul><li><code>Last-Modified</code> - è¿™ä¸ªå¤´çš„å€¼è¡¨æ˜æ‰€è¯·æ±‚çš„èµ„æºä¸Šæ¬¡ä¿®æ”¹çš„æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚æœ€è¿‘ç…§ç‰‡çš„æ—¶é—´çº¿ï¼Œ<code>/photos/timeline</code>ï¼Œ<code>Last-Modified</code> çš„å€¼å¯ä»¥æ˜¯æœ€è¿‘ä¸€å¼ ç…§ç‰‡çš„æ‹æ‘„æ—¶é—´ã€‚</li><li><code>Etag</code> - è¿™æ˜¯ â€œentity tagâ€ çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¡¨ç¤ºæ‰€è¯·æ±‚èµ„æºçš„å†…å®¹çš„æ ‡è¯†ç¬¦ã€‚åœ¨å®è·µä¸­ï¼Œ<code>Etag</code> çš„å€¼å¯ä»¥æ˜¯ç±»ä¼¼äºèµ„æºçš„ <a href=https://en.wikipedia.org/wiki/MD5><code>MD5</code></a> ä¹‹ç±»çš„ä¸œè¥¿ã€‚è¿™å¯¹äºé‚£äº›åŠ¨æ€ç”Ÿæˆçš„ã€å¯èƒ½æ²¡æœ‰æ˜æ˜¾çš„ <code>Last-Modified</code> å€¼çš„èµ„æºéå¸¸æœ‰ç”¨ã€‚</li></ul><h2 id=nsurlconnectiondelegate><code>NSURLConnectionDelegate</code></h2><p>ä¸€æ—¦æ”¶åˆ°äº†æœåŠ¡å™¨çš„å›åº”ï¼Œ<code>NSURLConnection</code> çš„ä»£ç†å°±æœ‰æœºä¼šåœ¨ <code>-connection:willCacheResponse:</code> ä¸­æŒ‡å®šç¼“å­˜æ•°æ®ã€‚</p><p><code>NSCachedURLResponse</code> æ˜¯ä¸ªåŒ…å« <code>NSURLResponse</code> ä»¥åŠå®ƒå¯¹åº”çš„ç¼“å­˜ä¸­çš„ <code>NSData</code> çš„ç±»ã€‚</p><p>åœ¨ <code>-connection:willCacheResponse:</code> ä¸­ï¼Œ<code>cachedResponse</code> å¯¹è±¡ä¼šæ ¹æ® URL è¿æ¥è¿”å›çš„ç»“æœè‡ªåŠ¨åˆ›å»ºã€‚å› ä¸º <code>NSCachedURLResponse</code> æ²¡æœ‰å¯å˜éƒ¨åˆ†ï¼Œä¸ºäº†æ”¹å˜ <code>cachedResponse</code> ä¸­çš„å€¼å¿…é¡»æ„é€ ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒæŠŠæ”¹å˜è¿‡çš„å€¼ä¼ å…¥ <code>â€“initWithResponse:data:userInfo:storagePolicy:</code>ï¼Œä¾‹å¦‚ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>- (NSCachedURLResponse <span style=color:#f92672>*</span>)<span style=color:#a6e22e>connection:</span>(NSURLConnection <span style=color:#f92672>*</span>)connection
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>willCacheResponse:</span>(NSCachedURLResponse <span style=color:#f92672>*</span>)cachedResponse
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    NSMutableDictionary <span style=color:#f92672>*</span>mutableUserInfo <span style=color:#f92672>=</span> [[cachedResponse userInfo] mutableCopy];
</span></span><span style=display:flex><span>    NSMutableData <span style=color:#f92672>*</span>mutableData <span style=color:#f92672>=</span> [[cachedResponse data] mutableCopy];
</span></span><span style=display:flex><span>    NSURLCacheStoragePolicy storagePolicy <span style=color:#f92672>=</span> NSURLCacheStorageAllowedInMemoryOnly;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [[NSCachedURLResponse alloc] initWithResponse:[cachedResponse response]
</span></span><span style=display:flex><span>                                                    data:mutableData
</span></span><span style=display:flex><span>                                                userInfo:mutableUserInfo
</span></span><span style=display:flex><span>                                           storagePolicy:storagePolicy];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¦‚æœ <code>-connection:willCacheResponse:</code> è¿”å› <code>nil</code>ï¼Œå›åº”å°†ä¸ä¼šç¼“å­˜ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>- (NSCachedURLResponse <span style=color:#f92672>*</span>)<span style=color:#a6e22e>connection:</span>(NSURLConnection <span style=color:#f92672>*</span>)connection
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>willCacheResponse:</span>(NSCachedURLResponse <span style=color:#f92672>*</span>)cachedResponse
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> nil;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¦‚æœä¸å®ç°æ­¤æ–¹æ³•ï¼Œ<code>NSURLConnection</code> å°±ç®€å•åœ°ä½¿ç”¨æœ¬æ¥è¦ä¼ å…¥ <code>-connection:willCacheResponse:</code> çš„é‚£ä¸ªç¼“å­˜å¯¹è±¡ï¼Œæ‰€ä»¥é™¤éä½ éœ€è¦æ”¹å˜ä¸€äº›å€¼æˆ–è€…é˜»æ­¢ç¼“å­˜ï¼Œå¦åˆ™è¿™ä¸ªä»£ç†æ–¹æ³•ä¸å¿…å®ç°ã€‚</p><h2 id=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹</h2><p>æ­£å¦‚å®ƒé‚£ä¸ªæ¯«æ— å…³ç³»ä½†æ˜¯åå­—ç›¸è¿‘çš„å°ä¼™ä¼´ <a href=https://nshipster.cn/nscache/><code>NSCache</code></a> ä¸€æ ·ï¼Œ<code>NSURLCache</code> ä¹Ÿæ˜¯æœ‰ä¸€äº›ç‰¹åˆ«çš„ã€‚</p><p>åœ¨ iOS 5ï¼Œç£ç›˜ç¼“å­˜å¼€å§‹æ”¯æŒï¼Œä½†ä»…æ”¯æŒ HTTPï¼Œé HTTPSï¼ˆiOS 6 ä¸­å¢åŠ äº†æ­¤æ”¯æŒï¼‰ã€‚Peter Steinberger <a href=http://petersteinberger.com/blog/2012/nsurlcache-uses-a-disk-cache-as-of-ios5/>å…³äºè¿™ä¸ªä¸»é¢˜å†™äº†ä¸€ç¯‡ä¼˜ç§€çš„æ–‡ç« </a>ï¼Œåœ¨æ·±å…¥ç ”ç©¶å†…éƒ¨ç»†èŠ‚åå®ç°<a href=https://github.com/steipete/SDURLCache>ä»–è‡ªå·±çš„ NSURLCache å­ç±»</a>ã€‚</p><p><a href=http://blackpixel.com/blog/2012/05/caching-and-nsurlconnection.html>Daniel Pasco åœ¨ Black Pixel ä¸Šçš„å¦ä¸€ç¯‡æ–‡ç« </a> æè¿°äº†ä¸€äº›ä¸æœåŠ¡å™¨é€šä¿¡æ—¶ä¸è®¾ç½®ç¼“å­˜å¤´çš„æ„å¤–çš„é»˜è®¤è¡Œä¸ºã€‚</p><hr><p><code>NSURLCache</code> æé†’ç€æˆ‘ä»¬ç†Ÿæ‚‰æˆ‘ä»¬æ­£åœ¨æ“ä½œçš„ç³»ç»Ÿæ˜¯å¤šä¹ˆåœ°é‡è¦ã€‚å¼€å‘ iOS æˆ– OS X ç¨‹åºæ—¶ï¼Œè¿™äº›ç³»ç»Ÿä¸­çš„é‡ä¸­ä¹‹é‡ï¼Œé <a href=https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html%23//apple_ref/doc/uid/10000165i>URL Loading System</a>è«å±ã€‚</p><p>æ— æ•°å¼€å‘è€…å°è¯•è‡ªå·±åšä¸€ä¸ªç®€é™‹è€Œè„†å¼±çš„ç³»ç»Ÿæ¥å®ç°ç½‘ç»œç¼“å­˜çš„åŠŸèƒ½ï¼Œæ®Šä¸çŸ¥ <code>NSURLCache</code> åªè¦ä¸¤è¡Œä»£ç å°±èƒ½æå®šä¸”å¥½ä¸Š100å€ã€‚ç”šè‡³æ›´å¤šå¼€å‘è€…æ ¹æœ¬ä¸çŸ¥é“ç½‘ç»œç¼“å­˜çš„å¥½å¤„ï¼Œä¹Ÿä»æœªå°è¯•è¿‡ï¼Œå¯¼è‡´ä»–ä»¬çš„åº”ç”¨å‘æœåŠ¡å™¨ä½œäº†æ— æ•°ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ã€‚</p><p>æ‰€ä»¥å¦‚æœä½ æƒ³çœ‹åˆ°ä¸–ç•Œçš„å˜åŒ–ï¼Œä½ æƒ³ç¡®ä¿ä½ æœ‰ç¨‹åºæ€»ä»¥æ­£ç¡®çš„æ–¹å¼å¼€å¯ï¼Œåœ¨ <code>-application:didFinishLaunchingWithOptions:</code> è®¾ç½®ä¸€ä¸ªå…±äº«çš„ <code>NSURLCache</code> å§ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2013-02-11 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Cocoa target=_blank>Cocoa</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>