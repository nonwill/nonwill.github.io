<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>UIReferenceLibraryViewController / DCSDictionaryRef</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="UIReferenceLibraryViewController / DCSDictionaryRef,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="UIReferenceLibraryViewController / DCSDictionaryRef,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>UIReferenceLibraryViewController / DCSDictionaryRef</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>Croath Liu</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>æœ¬å‘¨çš„ä¸»é¢˜æ˜¯å­—å…¸ã€‚æˆ‘ä»¬è®¨è®ºçš„ä¸æ˜¯æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸é‡åˆ°çš„<code>NSDictionary</code> æˆ– <code>CFDictionaryRef</code>ï¼Œè€Œæ˜¯å·²ç»ç¦»ä½ è¿œå»äº†çš„ã€å­¦ç”Ÿæ—¶ä»£å¸¸ç”¨çš„å­—å…¸ã€‚</p><blockquote><p>ä¸è¿‡å¦‚æœè®¤çœŸè®¨è®ºä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆå­—å…¸ä¼šè¢«ç§°ä½œâ€œå­—å…¸â€å‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½åƒRubyè¯­è¨€ç­‰ç›´æ¥å«å®ƒå“ˆå¸Œï¼ˆ<code>Hash</code>ï¼‰ï¼Ÿå­—å…¸åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿä¸æ–­é€šè¿‡Hashå‡½æ•°åŠ å¯†å†…å®¹æ¥è§£é‡Šè¯­ä¹‰ï¼Ÿå“ˆå“ˆï¼Œå­—å…¸å…¶å®æ²¡é‚£ä¹ˆç³Ÿç³•å§ã€‚æˆ‘è®¤ä¸ºç”¨â€œç»„åˆèµ·æ¥çš„æ•°ç»„â€æ¥æè¿°ä»–å†é€‚åˆä¸è¿‡äº†ã€‚</p></blockquote><p>è™½ç„¶å­—å…¸çš„åœ°ä½å¾ˆå¤§ç¨‹åº¦ä¸Šå·²ç»è¢«åŸºäºç½‘ç»œçš„â€œä¸€é”®é‡Šä¹‰â€åŠŸèƒ½æ‰€æ›¿ä»£ï¼Œä½†æ˜¯å­—å…¸å’Œè¯æ±‡è¡¨åœ¨æ‹¼å†™æ£€æŸ¥ã€è¯­æ³•æ£€æŸ¥ã€è‡ªåŠ¨çº é”™ã€è‡ªåŠ¨æ‘˜è¦ã€è¯­ä¹‰åˆ†æç­‰é¢†åŸŸï¼Œä»ç„¶åœ¨å¹•åæ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚æ‰€ä»¥ä¸ºäº†æ–¹ä¾¿ä¸‹é¢çš„è®¨è®ºï¼Œæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹å­—å…¸åœ¨Unixã€OS Xå’ŒiOSç³»ç»Ÿä¸Šçš„å±•ç°å½¢å¼å’Œè¢«èµ‹äºˆçš„æ„ä¹‰ã€‚</p><hr><h2 id=unix>Unix</h2><p>å‡ ä¹æ‰€æœ‰Unixçš„å‘è¡Œç‰ˆéƒ½åŒ…å«ä¸€äº›ç”¨æ¢è¡Œåˆ†å‰²çš„è¯è¡¨æ–‡ä»¶ã€‚åœ¨OS Xä¸Šï¼Œä½ å¯ä»¥åœ¨<code>/usr/share/dict</code>æ‰¾åˆ°ä»–ä»¬ï¼š</p><pre tabindex=0><code>$ ls /usr/share/dict
    README
    connectives
    propernames
    web2
    web2a
    words@ -&gt; web2
</code></pre><p>è¿æ¥åˆ°<code>words</code>çš„<code>web2</code>è¯è¡¨ï¼Œè™½ç„¶å†…å®¹ä¸æ˜¯å¾ˆè¯¦å°½ï¼Œä½†è¿˜æ˜¯ç›¸å½“å äº†ç›¸å½“å¤§çš„ç©ºé—´çš„ï¼š</p><pre tabindex=0><code>$ wc /usr/share/dict/words
    235886  235886 2493109
</code></pre><p>å¦‚æœä½ æŠŠå®ƒçš„å¤´éƒ¨æ‰“å‡ºæ¥ä½ å°±ä¼šå‘ç°å…¶å®è¿™é‡Œé¢çš„å†…å®¹ç›¸å½“æœ‰è¶£ã€‚æˆ‘å¼‚å¸¸å…´å¥‹åœ°å‘ç°äº†ä¸€å †ä»¥"a"å¼€å¤´çš„è¯ï¼š</p><pre tabindex=0><code>$ head /usr/share/dict/words
    A
    a
    aa
    aal
    aalii
    aam
    Aani
    aardvark
    aardwolf
    Aaron
</code></pre><p>è¿™äº›ç³»ç»Ÿæä¾›çš„å·¨å¤§è¯è¡¨æ–‡ä»¶è®©<code>grep</code>çºµæ¨ªäº¤é”™çš„æ–‡å­—éš¾é¢˜ã€ç”Ÿæˆæ˜“äºè®°å¿†çš„å¯†ç ã€ç§å­æ•°æ®åº“éƒ½å˜å¾—ç®€å•ã€‚ä½†ä»ç”¨æˆ·çš„è§†è§’æ¥çœ‹ï¼Œ<code>/usr/share/dict</code>åªæ˜¯ä¸€ä¸ªç¼ºä¹æ•´ä½“æ„ä¹‰çš„å•è¯è¡¨ï¼Œæ‰€ä»¥å¯¹æ—¥å¸¸çš„ä½¿ç”¨æ²¡ä»€ä¹ˆå¤ªå¤§æ„ä¹‰ã€‚</p><p>OS Xåœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ„å»ºäº†ç³»ç»Ÿè¯å…¸ã€‚OS Xåœ¨å¯¹æ‰©å±•å£®å¤§Unixçš„åŠŸèƒ½æ€§æ–¹é¢ä»æœªè®©äººå¤±æœ›ï¼Œäºæ˜¯å®ƒä¸é—ä½™åŠ›åœ°å‘å¸ƒäº†å¾ˆå¤šåŸºäºbundleså’Œplistæ–‡ä»¶çš„å­—å…¸ã€‚</p><hr><h2 id=os-x>OS X</h2><p>OS Xæ¨¡ä»¿<code>/usr/share/dict</code>çš„ç»“æ„ï¼Œåˆ›é€ äº†<code>/Library/Dictionaries</code>ç›®å½•ã€‚
æˆ‘ä»¬ç°åœ¨å°±çœ‹ä¸€ä¸‹OS Xåœ¨å…±äº«æ€§çš„ç³»ç»Ÿå­—å…¸æ–¹é¢æ¯”Unixæœ‰æ‰€è¶…è¶Šçš„åœ°æ–¹â€”â€”â€”â€”å®ƒåŒæ ·è®¤åŒéè‹±è¯­å­—å…¸çš„å­˜åœ¨ï¼š</p><pre tabindex=0><code>$ ls /Library/Dictionaries/

    Apple Dictionary.dictionary/
    Diccionario General de la Lengua EspanÌƒola Vox.dictionary/
    Duden Dictionary Data Set I.dictionary/
    Dutch.dictionary/
    Italian.dictionary/
    Korean - English.dictionary/
    Korean.dictionary/
    Multidictionnaire de la langue francÌ§aise.dictionary/
    New Oxford American Dictionary.dictionary/
    Oxford American Writer&#39;s Thesaurus.dictionary/
    Oxford Dictionary of English.dictionary/
    Oxford Thesaurus of English.dictionary/
    Sanseido Super Daijirin.dictionary/
    Sanseido The WISDOM English-Japanese Japanese-English Dictionary.dictionary/
    Simplified Chinese - English.dictionary/
    The Standard Dictionary of Contemporary Chinese.dictionary/
</code></pre><p>OS Xä¸ºæˆ‘ä»¬å¸¦æ¥äº†åŒ…æ‹¬è‹±æ–‡å­—å…¸åœ¨å†…çš„æ±‰è¯­ã€æ³•è¯­ã€å¾·è¯­ã€æ„å¤§åˆ©è¯­ã€æ—¥è¯­ã€éŸ©è¯­ä¸“ä¸šå­—å…¸ï¼Œç”šè‡³åŒ…å«ä¸€ä¸ªä¸“é—¨è®²è§£Appleæœ¯è¯­çš„å­—å…¸ï¼</p><p>è®©æˆ‘ä»¬ç ”ç©¶çš„æ›´æ·±ä¸€ç‚¹ï¼Œçœ‹çœ‹è¿™äº›<code>.dictionary</code>çš„bundleæ–‡ä»¶é‡Œé¢åˆ°åº•æœ‰ä»€ä¹ˆï¼š</p><pre tabindex=0><code>$ ls &#34;/Library/Dictionaries/New Oxford American Dictionary.dictionary/Contents&#34;

    Body.data
    DefaultStyle.css
    EntryID.data
    EntryID.index
    Images/
    Info.plist
    KeyText.data
    KeyText.index
    Resources/
    _CodeSignature/
    version.plist
</code></pre><p>é€šè¿‡å¯¹å­—å…¸æ–‡ä»¶ç»“æ„çš„è§‚å¯Ÿï¼Œç¡®å®å¯ä»¥å‘ç°ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ã€‚è§‚å¯Ÿæ–°ç‰›æ´¥å­—å…¸ï¼ˆNew Oxford American Dictionaryï¼‰ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ï¼š</p><ul><li>äºŒè¿›åˆ¶ç¼–ç çš„ <code>KeyText.data</code>ã€<code>KeyText.index</code>å’Œ<code>Content.data</code>æ–‡ä»¶</li><li>ç”¨äºç»˜åˆ¶çš„CSSæ–‡ä»¶</li><li>ä»A-Frameåˆ°Zitherå…±1207å¼ å›¾ç‰‡</li><li>ç”¨äºåˆ‡æ¢åˆ°<a href=https://en.wikipedia.org/wiki/Pronunciation_respelling_for_English>US English Diacritical Pronunciation</a>å’Œ<a href=https://en.wikipedia.org/wiki/International_Phonetic_Alphabet>IPA</a> (International Phonetic Alphabet)çš„é“¾æ¥</li><li>Manifestå’Œç­¾åæ–‡ä»¶</li></ul><p>é€šå¸¸æƒ…å†µä¸‹æ‹¥æœ‰å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¯»æƒé™æ‰å¯ä»¥è·å¾—ç›¸å…³çš„æ•°æ®ï¼Œä½†å¹¸è¿çš„æ˜¯Core Servicesä¸ºæˆ‘ä»¬æä¾›äº†ç›¸å…³çš„APIã€‚</p><h4 id=è·å–å•è¯çš„é‡Šä¹‰>è·å–å•è¯çš„é‡Šä¹‰</h4><p>åœ¨OS Xè·å–ä¸€ä¸ªå•è¯çš„é‡Šä¹‰ï¼Œéœ€è¦ç”¨åˆ°Core Services frameworkçš„<code>DCSCopyTextDefinition</code>å‡½æ•°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#import &lt;CoreServices/CoreServices.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>NSString <span style=color:#f92672>*</span>word <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;apple&#34;</span>;
</span></span><span style=display:flex><span>NSString <span style=color:#f92672>*</span>definition <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge_transfer</span> NSString <span style=color:#f92672>*</span>)DCSCopyTextDefinition(NULL, (<span style=color:#66d9ef>__bridge</span> CFStringRef)word, CFRangeMake(<span style=color:#ae81ff>0</span>, [word length]));
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>, definition);
</span></span></code></pre></div><p>å…ˆåˆ«æ€¥ç”¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›ç‰›é€¼çš„å­—å…¸åˆ°åº•æ˜¯æ€ä¹ˆè¢«è·å–æ•°æ®çš„ã€‚</p><p>çœ‹èµ·æ¥è¿™äº›å­—å…¸å¥½åƒéƒ½è¿›åˆ°äº†ç¬¬ä¸€ä¸ª<code>NULL</code>å‚æ•°é‡Œã€‚æŒ‰ç…§è¿™ä¸ªå‡½æ•°çš„å®šä¹‰æ¥æ”¶ï¼Œä½ å¯èƒ½æƒ³åœ¨è¿™é‡Œæ”¾ä¸€ä¸ª<code>DCSCopyTextDefinition</code>ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰publicçš„å‡½æ•°è®©ä½ ä½¿ç”¨è¿™ä¸ªç±»å‹ï¼Œæ‰€ä»¥è®©å®ƒæˆä¸º<code>NULL</code>æ˜¯å”¯ä¸€çš„è§£å†³åŠæ³•äº†ï¼Œå°±å¦‚æ–‡æ¡£é‡Œé¢æ‰€è¯´ï¼š</p><blockquote><p>æ­¤å‚æ•°ä¸ºé¢„ç•™å‚æ•°ï¼Œå¯èƒ½åœ¨ä»¥åä¼šè¢«ç”¨åˆ°ï¼Œç›®å‰æš‚æ—¶ä¼ é€’<code>NULL</code>å³å¯ã€‚å­—å…¸æœåŠ¡ä¼šåœ¨æ‰€æœ‰å¯ç”¨çŠ¶æ€ï¼ˆactiveï¼‰çš„å­—å…¸ä¸­æœç´¢ç›¸å…³ä¿¡æ¯ã€‚</p></blockquote><p>&ldquo;åœ¨<strong>æ‰€æœ‰å¯ç”¨çŠ¶æ€çš„å­—å…¸</strong>ä¸­æœç´¢ç›¸å…³ä¿¡æ¯&rdquo;ï¼Ÿå¬èµ·æ¥åƒä¸€ä¸ªæ¼æ´å•Šï¼</p><h4 id=å°†å­—å…¸è®¾ä¸ºå¯ç”¨activeçŠ¶æ€>å°†å­—å…¸è®¾ä¸ºå¯ç”¨ï¼ˆActiveï¼‰çŠ¶æ€</h4><p>Now, there&rsquo;s nothing programmers love to hate to love more than the practice of exploiting loopholes to side-step Apple platform restrictions. Behold: an entirely error-prone approach to getting, say, thesaurus results instead of the first definition available in the standard dictionary:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSUserDefaults <span style=color:#f92672>*</span>userDefaults <span style=color:#f92672>=</span> [NSUserDefaults standardUserDefaults];
</span></span><span style=display:flex><span>NSMutableDictionary <span style=color:#f92672>*</span>dictionaryPreferences <span style=color:#f92672>=</span> [[userDefaults persistentDomainForName:<span style=color:#e6db74>@&#34;com.apple.DictionaryServices&#34;</span>] mutableCopy];
</span></span><span style=display:flex><span>NSArray <span style=color:#f92672>*</span>activeDictionaries <span style=color:#f92672>=</span> [dictionaryPreferences objectForKey:<span style=color:#e6db74>@&#34;DCSActiveDictionaries&#34;</span>];
</span></span><span style=display:flex><span>dictionaryPreferences[<span style=color:#e6db74>@&#34;DCSActiveDictionaries&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>@[</span><span style=color:#e6db74>@&#34;/Library/Dictionaries/Oxford American Writer&#39;s Thesaurus.dictionary&#34;</span><span style=color:#ae81ff>]</span>;
</span></span><span style=display:flex><span>[userDefaults setPersistentDomain:dictionaryPreferences forName:<span style=color:#e6db74>@&#34;com.apple.DictionaryServices&#34;</span>];
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    NSString <span style=color:#f92672>*</span>word <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;apple&#34;</span>;
</span></span><span style=display:flex><span>    NSString <span style=color:#f92672>*</span>definition <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge_transfer</span> NSString <span style=color:#f92672>*</span>)DCSCopyTextDefinition(NULL, (<span style=color:#66d9ef>__bridge</span> CFStringRef)word, CFRangeMake(<span style=color:#ae81ff>0</span>, [word length]));
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>, definition);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>dictionaryPreferences[<span style=color:#e6db74>@&#34;DCSActiveDictionaries&#34;</span>] <span style=color:#f92672>=</span> activeDictionaries;
</span></span><span style=display:flex><span>[userDefaults setPersistentDomain:dictionaryPreferences forName:<span style=color:#e6db74>@&#34;com.apple.DictionaryServices&#34;</span>];
</span></span></code></pre></div><p>çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šæ„¤æ€’åœ°è¯´ï¼š&ldquo;ä½†è¿™æ˜¯OS Xå•Šï¼Œä¸€èˆ¬åº”ç”¨æ˜¯ä¸èƒ½é€šè¿‡æ²™ç®±ä»Cupertinoè·å–manifestæƒé™çš„ï¼Œå°±æ²¡æœ‰æ›´æ–¹ä¾¿çš„æ–¹æ³•ä¹ˆï¼Ÿæ¯”å¦‚è¯´ç§æœ‰APIï¼Ÿ&rdquo;</p><p>ç­”æ¡ˆæ˜¯ï¼šå½“ç„¶æœ‰ã€‚</p><h3 id=ç§æœ‰api>ç§æœ‰API</h3><p>è¿™äº›APIæ²¡æœ‰å…¬å¼€æš´éœ²å‡ºæ¥ï¼Œä½†æ˜¯ä¸ºäº†æ»¡è¶³æˆ‘ä»¬å¯¹å­—å…¸çš„æ¸´æœ›ï¼Œè¿™äº›APIä»ç„¶èƒ½å¤Ÿé€šè¿‡è°ƒç”¨Core Servicesçš„ä¸€äº›å‡½æ•°æ¥å®ç°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFArrayRef <span style=color:#a6e22e>DCSCopyAvailableDictionaries</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSDictionaryGetName</span>(DCSDictionaryRef dictionary);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSDictionaryGetShortName</span>(DCSDictionaryRef dictionary);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> DCSDictionaryRef <span style=color:#a6e22e>DCSDictionaryCreate</span>(CFURLRef url);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSDictionaryGetName</span>(DCSDictionaryRef dictionary);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFArrayRef <span style=color:#a6e22e>DCSCopyRecordsForSearchString</span>(DCSDictionaryRef dictionary, CFStringRef string, <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>, <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFDictionaryRef <span style=color:#a6e22e>DCSCopyDefinitionMarkup</span>(DCSDictionaryRef dictionary, CFStringRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordCopyData</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordCopyDataURL</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordGetAnchor</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordGetAssociatedObj</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordGetHeadword</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordGetRawHeadword</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordGetString</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> CFStringRef <span style=color:#a6e22e>DCSRecordGetTitle</span>(CFTypeRef record);
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> DCSDictionaryRef <span style=color:#a6e22e>DCSRecordGetSubDictionary</span>(CFTypeRef record);
</span></span></code></pre></div><p>è¿™äº›APIéƒ½æ˜¯ç§æœ‰çš„ï¼Œæ‰€ä»¥å½“ç„¶ä¹Ÿä¸ä¼šæœ‰æ–‡æ¡£æ¥è§£é‡Šä»–ä»¬çš„ç”¨é€”å’Œä½¿ç”¨æ–¹æ³•ï¼Œæ‰€ä»¥å…ˆæ¥çœ‹ä¸€ä¸‹åˆ°åº•æ€ä¹ˆç”¨è¿™äº›APIå§ï¼š</p><h4 id=è·å–å¯ç”¨å­—å…¸>è·å–å¯ç”¨å­—å…¸</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSMapTable <span style=color:#f92672>*</span>availableDictionariesKeyedByName <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    [NSMapTable mapTableWithKeyOptions:NSPointerFunctionsCopyIn
</span></span><span style=display:flex><span>                          valueOptions:NSPointerFunctionsObjectPointerPersonality];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>id</span> dictionary <span style=color:#66d9ef>in</span> (<span style=color:#66d9ef>__bridge_transfer</span> NSArray <span style=color:#f92672>*</span>)DCSCopyAvailableDictionaries()) {
</span></span><span style=display:flex><span>    NSString <span style=color:#f92672>*</span>name <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge</span> NSString <span style=color:#f92672>*</span>)DCSDictionaryGetName((<span style=color:#66d9ef>__bridge</span> DCSDictionaryRef)dictionary);
</span></span><span style=display:flex><span>    [availableDictionariesKeyedByName setObject:dictionary forKey:name];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=è·å–å•è¯é‡Šä¹‰>è·å–å•è¯é‡Šä¹‰</h4><p>åœ¨ä¸Šè¿°å¤„ç†ä¸­è·å–äº†å¾ˆå¤šéš¾ä»¥ç¢ç£¨çš„<code>DCSDictionaryRef</code>ç±»å‹çš„å®ä¾‹ï¼Œç°åœ¨ç”¨è¿™äº›å®ä¾‹æˆ‘ä»¬æ¥çœ‹çœ‹èƒ½å¯¹ç¬¬ä¸€ä¸ªå‚æ•°<code>DCSCopyTextDefinition</code>åšäº›ä»€ä¹ˆäº‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span>word <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;apple&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (NSString <span style=color:#f92672>*</span>name <span style=color:#66d9ef>in</span> availableDictionariesKeyedByName) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>id</span> dictionary <span style=color:#f92672>=</span> [availableDictionariesKeyedByName objectForKey:name];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    CFRange termRange <span style=color:#f92672>=</span> DCSGetTermRangeInString((<span style=color:#66d9ef>__bridge</span> DCSDictionaryRef)dictionary, (<span style=color:#66d9ef>__bridge</span> CFStringRef)word, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (termRange.location <span style=color:#f92672>==</span> kCFNotFound) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    NSString <span style=color:#f92672>*</span>term <span style=color:#f92672>=</span> [word substringWithRange:NSMakeRange(termRange.location, termRange.length)];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    NSArray <span style=color:#f92672>*</span>records <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge_transfer</span> NSArray <span style=color:#f92672>*</span>)DCSCopyRecordsForSearchString((<span style=color:#66d9ef>__bridge</span> DCSDictionaryRef)dictionary, (<span style=color:#66d9ef>__bridge</span> CFStringRef)term, NULL, NULL);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (records) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>id</span> record <span style=color:#66d9ef>in</span> records) {
</span></span><span style=display:flex><span>            NSString <span style=color:#f92672>*</span>headword <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge</span> NSString <span style=color:#f92672>*</span>)DCSRecordGetHeadword((<span style=color:#66d9ef>__bridge</span> CFTypeRef)record);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (headword) {
</span></span><span style=display:flex><span>                NSString <span style=color:#f92672>*</span>definition <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge_transfer</span> NSString<span style=color:#f92672>*</span>)DCSCopyTextDefinition((<span style=color:#66d9ef>__bridge</span> DCSDictionaryRef)dictionary, (<span style=color:#66d9ef>__bridge</span> CFStringRef)headword, CFRangeMake(<span style=color:#ae81ff>0</span>, [headword length]));
</span></span><span style=display:flex><span>                NSLog(<span style=color:#e6db74>@&#34;%@: %@&#34;</span>, name, definition);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                NSString <span style=color:#f92672>*</span>HTML <span style=color:#f92672>=</span> (<span style=color:#66d9ef>__bridge_transfer</span> NSString<span style=color:#f92672>*</span>)DCSRecordCopyData((<span style=color:#66d9ef>__bridge</span> DCSDictionaryRef)dictionary, (<span style=color:#66d9ef>__bridge</span> CFStringRef)headword, CFRangeMake(<span style=color:#ae81ff>0</span>, [headword length]));
</span></span><span style=display:flex><span>                NSLog(<span style=color:#e6db74>@&#34;%@: %@&#34;</span>, name, definition);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™ç§æ–¹æ³•æœ€æœ‰è¶£çš„åœ°æ–¹æ˜¯ä½ è¦ä»HTMLæ ¼å¼çš„å†…å®¹ä¸­æ¥è·å–æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè¿™äº›HTMLè¿˜åŒ…å«äº†CSSæ–‡ä»¶ï¼Œä»–ä»¬éƒ½æ˜¯ç”¨æ¥åœ¨ç³»ç»Ÿçš„å­—å…¸åº”ç”¨(Dictionary.app)æ¥æ˜¾ç¤ºå†…å®¹ç”¨çš„ã€‚</p><blockquote><p>å¦‚æœä½ æ˜¯ä¸ªå¥½å¥‡å®å®ï¼Œæˆ–è€…æ˜¯å¯¹è¯­è¨€å­¦æœ‰åçˆ±çš„æ€ªå’–ï¼Œå¯ä»¥çœ‹çœ‹<a href=https://gist.github.com/mattt/9453538>å•è¯"apple"çš„HTMLä¿¡æ¯</a>ã€‚</p></blockquote><p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘é¡ºä¾¿ä¹Ÿå°±å†™äº†ä¸€ä¸ª<a href=https://github.com/mattt/DictionaryKit>Objective-C wrapper</a>ï¼Œè¿™ä¸ªåº“é€šè¿‡ç§æœ‰APIä»æˆ‘ä»¬å–œçˆ±çš„æ°´æœå…¬å¸æ¥å–ç¦æœï¼ˆæ‰€ä»¥ä¸è¦æŠŠè¿™ä¸ªåº“æ”¾åˆ°ä½ éœ€è¦æäº¤åˆ°App Storeçš„åº”ç”¨ä¸­ä½¿ç”¨ï¼‰ã€‚</p><hr><h2 id=ios>iOS</h2><p>iOSå¼€å‘æ¯«æ— ç–‘é—®æ˜¯ä¸€ä»¶ç…§æœ¬å®£ç§‘çš„äº‹ï¼Œæ‰€ä»¥å°è¯•é€†å‘å·¥ç¨‹ä¼šæ¯”æŠ€æœ¯å°è¯•æ›´æœ‰ç”¨ä¸€ç‚¹ã€‚å¹¸è¿çš„æ˜¯å¹¶ä¸éœ€è¦è¿™æ ·åšäº†ï¼Œå› ä¸ºæœ‰ä¸€æ‰¹å…³äºUIKitçš„<code>UIReferenceLibraryViewController</code>åœ¨iOS5ä¹‹åAPIå·²ç»å¼€æ”¾ã€‚</p><p><code>UIReferenceLibraryViewController</code>å’Œ<code>MFMessageComposeViewController</code>å¾ˆç›¸ä¼¼ï¼Œæä¾›äº†æœ€å°åŒ–é…ç½®çš„ç³»ç»Ÿå±‚view controllerï¼Œå¯ä»¥ç›´æ¥è¢«presentæ˜¾ç¤ºã€‚</p><p>ç”¨éœ€è¦æŸ¥æ‰¾termæ¥è¿›è¡Œåˆå§‹åŒ–ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>UIReferenceLibraryViewController <span style=color:#f92672>*</span>referenceLibraryViewController <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    [[UIReferenceLibraryViewController alloc] initWithTerm:<span style=color:#e6db74>@&#34;apple&#34;</span>];
</span></span><span style=display:flex><span>[viewController presentViewController:referenceLibraryViewController
</span></span><span style=display:flex><span>                             animated:YES
</span></span><span style=display:flex><span>                           completion:nil];
</span></span></code></pre></div><p>è¿™ç§è¡Œä¸ºå’Œç”¨æˆ·ç‚¹å‡»<code>UITextView</code>ä¸­é«˜äº®è¯æ±‡å¼¹å‡ºçš„"å®šä¹‰"çš„<code>UIMenuItem</code>çš„æ•ˆæœå·®ä¸å¤šã€‚</p><p><code>UIReferenceLibraryViewController</code>ä¹Ÿæä¾›äº†ä¸€ä¸ªç±»æ–¹æ³•<code>dictionaryHasDefinitionForTerm:</code>ï¼Œå¼€å‘è€…å¯ä»¥åœ¨dictionary view controllerå‡ºç°ä¹‹å‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±å¯ä»¥åœ¨ä¸å¿…éœ€çš„æ—¶å€™ä¸æ˜¾ç¤ºé‚£ä¸ªview controlleräº†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[UIReferenceLibraryViewController dictionaryHasDefinitionForTerm:<span style=color:#e6db74>@&#34;apple&#34;</span>];
</span></span></code></pre></div><blockquote><p>åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œ<code>UIReferenceLibraryViewController</code>ä¼šä»¥éå¸¸å¥½çš„å½¢å¼å»æ ¼å¼åŒ–æœç´¢ç»“æœï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å»æ‰ç©ºæ ¼æˆ–è€…è°ƒæ•´å¤§å°å†™æ¥ä¼˜åŒ–æœç´¢ã€‚</p></blockquote><hr><p>æ— è®ºæ˜¯Unixçš„è¯æ±‡è¡¨è¿˜æ˜¯åŸºäºå…¶å‘å±•è€Œæ¥çš„OS Xï¼ˆæˆ–iOSï¼‰çš„<code>.dictionary</code> bundlesï¼Œå®ƒä¸æ•°å­¦å¸¸é‡ä»¥åŠAppleçš„"Sosumi"æé†’ä¸€æ ·ï¼Œå¯¹äºç¼–ç¨‹æ¥è¯´éƒ½æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½ å¯ä»¥æ€è€ƒä¸€ä¸‹å¦‚ä½•å°†ä¸Šè¿°APIå¼•å…¥ä½ çš„appï¼Œæˆ–è€…ç”¨å®ƒä»¬æ¥åˆ›å»ºä½ ä»¥å‰ä»æœªå°è¯•è¿‡çš„åº”ç”¨ã€‚è¿™é‡Œæœ‰å¾ˆå¤šAppleç³»ç»Ÿå†…éƒ¨å…³äºè¯­è¨€å­¦çš„é“¾æ¥ä¾›ä½ å‚è€ƒï¼ša <a href=https://nshipster.com/nslocalizedstring/>wealth</a> <a href=https://nshipster.com/nslinguistictagger/>of</a> <a href=https://nshipster.com/search-kit/>linguistic</a> <a href=https://nshipster.com/uilocalizedindexedcollation/>technologies</a>ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2014-03-10 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Cocoa target=_blank>Cocoa</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>