<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>nil / Nil / NULL / NSNull</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="nil / Nil / NULL / NSNull,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="nil / Nil / NULL / NSNull,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"🌜"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>nil / Nil / NULL / NSNull</span><span class=btRight><span title="Author · 作者" class=author>Mattt</span> <span title="Translator · 翻译" class=author>Zihan Xu</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post · 关联或转载引用的文章" target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics · 回主题页">&#127793;</a></span></h1><p>理解“不存在”的概念不仅仅是一个哲学的问题，也是一个实际的问题。我们是 <em>有形</em> 宇宙的居民，而原因在于逻辑宇宙的存在不确定性。作为一个逻辑系统的物理体现，电脑面临一个棘手的问题，就是如何用 <em>存在</em> 表达 <em>不存在</em> .</p><p>在 Objective－C 中，有几个不同种类的 <em>不存在</em>。这样做的原因要追溯到<a href=https://nshipster.com/ns_enum-ns_options/>一个频繁提及的NSHipster</a>，讲解 Objective-C 如何在 C 的程序范例以及由 Smalltalk 启发的面向对象的范例中架起桥梁的。</p><p>C 用 <code>0</code> 来作为 <em>不存在</em> 的原始值，而 <code>NULL</code> 作为指针(<a href=http://c-faq.com/null/nullor0.html>这在指针环境中相当于<code>0</code></a>)。</p><p>Objective-C 在 C 的表达 <em>不存在</em> 的基础上增加了 <code>nil</code>。<code>nil</code> 是一个指向不存在的 <em>对象</em> 指针。虽然它在语义上与 <code>NULL</code> 不同，但它们在技术上是相等的。</p><p>在框架层面，Foundation 定义了 <code>NSNull</code>，即一个类方法 <code>+null</code>，它返回一个单独的 <code>NSNull</code> 对象。<code>NSNull</code> 与 <code>nil</code> 以及 <code>NULL</code> 不同，因为它是一个实际的对象，而不是一个零值。</p><p>另外，在 <a href=https://gist.github.com/4469665>Foundation/NSObjCRuntime.h</a> 中，<code>Nil</code> 被定义为指向零的 <em>类</em> 指针。这个<code>nil</code>的鲜为人知的大写的表兄并不常常出现，但它至少值得注意。</p><h2 id=关于-nil-的一些事>关于 <code>nil</code> 的一些事</h2><p>刚被 <code>分配</code> 的 <code>NSObject</code> 的<a href=https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html>内容被设置为<code>0</code></a>。也就是说那个对象所有的指向其他对象的指针都从 <code>nil</code> 开始，所以在 <code>init</code> 方法中设置 <code>self.(association) = nil</code> 之类的表达是没有必要的。</p><p>也许 <code>nil</code> 最显著的行为是，它虽然为零，仍然可以有消息发送给它。</p><p>在其他的语言中，比如 C++，这样做会使你的程序崩溃，但在 Objective-C 中，在 <code>nil</code> 上调用方法返回一个零值。这大大的简化了表达，因为它避免了在使用 <code>nil</code> 之前对它的检查：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// 举个例子，这个表达...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (name <span style=color:#f92672>!=</span> nil <span style=color:#f92672>&amp;&amp;</span> [name isEqualToString:<span style=color:#e6db74>@&#34;Steve&#34;</span>]) { ... }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// …可以被简化为：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> ([name isEqualToString:<span style=color:#e6db74>@&#34;steve&#34;</span>]) { ... }
</span></span></code></pre></div><p>了解 <code>nil</code> 如何在 Objective-C 中工作可以让你将这个便利变成一个功能，而不是潜伏在你的应用中的 bug。要确保避免当 <code>nil</code> 值不需要的情况，要么通过检查或者提前返回来安静的失败，或者通过增加一个 <code>NSParameterAssert</code> 来抛出异常。</p><h2 id=nsnull有作没有><code>NSNull</code>：有作没有</h2><p><code>NSNull</code> 在 Foundation 和其它框架中被广泛的使用，以解决如 <code>NSArray</code> 和 <code>NSDictionary</code> 之类的集合不能有 <code>nil</code> 值的缺陷。你可以将 <code>NSNull</code> 理解为有效的将 <code>NULL</code> 或者 <code>nil</code> 值封装<a href=https://en.wikipedia.org/wiki/Object_type_(object-oriented_programming)#Boxing>boxing</a>，以达到在集合中使用它们的目的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSMutableDictionary <span style=color:#f92672>*</span>mutableDictionary <span style=color:#f92672>=</span> [NSMutableDictionary dictionary];
</span></span><span style=display:flex><span>mutableDictionary[<span style=color:#e6db74>@&#34;someKey&#34;</span>] <span style=color:#f92672>=</span> [NSNull null]; <span style=color:#75715e>// Sets value of NSNull singleton for `someKey`
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSLog(<span style=color:#e6db74>@&#34;Keys: %@&#34;</span>, [mutableDictionary allKeys]); <span style=color:#75715e>// @[@&#34;someKey&#34;]
</span></span></span></code></pre></div><hr><p>总的来说，这里的四个表达 <em>没有</em> 的值是每个 Objective-C 程序员都应该知道的：</p><table><thead><tr><th>标志</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td><tt>NULL</tt></td><td><tt>(void *)0</tt></td><td>C指针的字面零值</td></tr><tr><td><tt>nil</tt></td><td><tt>(id)0</tt></td><td>Objective-C对象的字面零值</td></tr><tr><td><tt>Nil</tt></td><td><tt>(Class)0</tt></td><td>Objective-C类的字面零值</td></tr><tr><td><tt>NSNull</tt></td><td><tt>[NSNull null]</tt></td><td>用来表示零值的单独的对象</td></tr></tbody></table><hr><p>除非<a href=https://nshipster.cn/ target=_blank>另有声明</a>，本文采用知识共享「<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>署名-非商业性使用 3.0 中国大陆</a>」许可协议授权。</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top · 回顶部" rel=nofollow>&#127772;2013-01-07 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2025 Mattt 版权所有</a><a href=https://autoptr.top/ title="Back to Home · 回首页">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>标签:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>分类:</span><li><a class=link href=https://autoptr.top/categories/Objective-C target=_blank>Objective-C</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>