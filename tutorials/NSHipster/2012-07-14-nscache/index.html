<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>NSCache</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="NSCache,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="NSCache,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>NSCache</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>Tony Li</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>å¯æ€œçš„ <code>NSCache</code> ä¸€ç›´å¤„äº <code>NSMutableDictionary</code> çš„é˜´å½±ä¹‹ä¸‹ã€‚å°±å¥½åƒæ²¡æœ‰äººçŸ¥é“å®ƒæä¾›äº†åƒåœ¾å¤„ç†çš„åŠŸèƒ½ï¼Œè€Œå¼€å‘è€…ä»¬å´è´¹åŠ²åŠ›æ°”åœ°å»è‡ªå·±å®ç°å®ƒã€‚</p><p>æ²¡é”™ï¼Œ<code>NSCache</code> åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªä¼šè‡ªåŠ¨ç§»é™¤å¯¹è±¡æ¥é‡Šæ”¾å†…å­˜çš„ <code>NSMutableDictionary</code>ã€‚æ— éœ€å“åº”å†…å­˜è­¦å‘Šæˆ–è€…ä½¿ç”¨è®¡æ—¶å™¨æ¥æ¸…é™¤ç¼“å­˜ã€‚å”¯ä¸€çš„ä¸åŒä¹‹å¤„æ˜¯é”®å¯¹è±¡ä¸ä¼šåƒ <code>NSMutableDictionary</code> ä¸­é‚£æ ·è¢«å¤åˆ¶ï¼Œè¿™å®é™…ä¸Šæ˜¯å®ƒçš„ä¸€ä¸ªä¼˜ç‚¹ï¼ˆé”®ä¸éœ€è¦å®ç° <code>NSCopying</code> åè®®ï¼‰ã€‚</p><p>å¦‚æœå¼€å‘è€…ä»¬çŸ¥é“å°±å¥½äº†â€¦â€¦</p><p>ä½†æ˜¯ï¼Œä½ å¹¶ä¸åƒå…¶ä»–å¼€å‘è€…é‚£æ ·ï¼Œå¯¹å§ï¼Ÿä½ åº”è¯¥ä¸ä¼šå°çœ‹ <code>NSCache</code> çš„ï¼Ÿ</p><p>è¿™å¹¶ä¸æ˜¯è¯´å®ƒæ²¡æœ‰ä¸€ä¸ç‘•ç–µå’Œä¸€äº›è«åå…¶å¦™çš„é—®é¢˜ã€‚<code>NSCache</code> å°±åƒæ˜¯ä¸ªçƒ«æ‰‹å±±èŠ‹ã€‚</p><p>æ‹¿ <code>setObject:forKey:cost:</code> æ¥è¯´ï¼Œå®ƒå’Œ <code>setObject:forKey:</code> æ–¹æ³•ç±»ä¼¼ï¼Œä½†æ˜¯å¸¦ç€ <code>cost</code> å‚æ•°ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œé‚£æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿå¥½å§ï¼Œå®˜æ–¹æ–‡æ¡£ç”šè‡³éƒ½æ²¡æœ‰è¯´æ¸…æ¥šï¼š</p><blockquote><p><code>cost</code> è¢«ç”¨æ¥è®¡ç®—ç¼“å­˜ä¸­æ‰€æœ‰å¯¹è±¡çš„ä»£ä»·ã€‚å½“å†…å­˜å—é™æˆ–è€…æ‰€æœ‰ç¼“å­˜å¯¹è±¡çš„æ€»ä»£ä»·è¶…è¿‡äº†æœ€å¤§å…è®¸çš„å€¼æ—¶ï¼Œç¼“å­˜ä¼šç§»é™¤å…¶ä¸­çš„ä¸€äº›å¯¹è±¡ã€‚</p></blockquote><p>å¾ˆå¥½ï¼Œç›®å‰ä¸ºæ­¢è¿˜ä¸é”™â€¦â€¦</p><blockquote><p>ç„¶è€Œï¼Œè¿™ä¸ªç§»é™¤æµç¨‹å¹¶ä¸ä¼šä¿è¯é¡ºåºã€‚åæœå°±æ˜¯ï¼Œå¦‚æœä½ æœŸæœ›é€šè¿‡æ§åˆ¶ <code>cost</code> çš„å€¼æ¥å®ŒæˆæŸäº›ç‰¹æ®Šè¡Œä¸ºçš„è¯ï¼Œç»“æœå¯èƒ½ä¼šå¯¹ä½ çš„ç¨‹åºæ— ç›Šã€‚</p></blockquote><p>å•Šï¼Ÿè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p><blockquote><p>é€šå¸¸ï¼Œç²¾ç¡®çš„ <code>cost</code> åº”è¯¥æ˜¯å¯¹è±¡å ç”¨çš„å­—èŠ‚æ•°ã€‚å¦‚æœå®ƒä¸å¯ä»¥ç›´æ¥è¯»å‡ºæ¥çš„è¯ï¼Œä½ æ²¡å¿…è¦è´¹åŠ²åœ°å»è®¡ç®—å®ƒï¼Œå› ä¸ºè¿™ä¹ˆåšçš„è¯ä¼šå¢åŠ ä½¿ç”¨ç¼“å­˜çš„ä»£ä»·ã€‚</p></blockquote><p>ç­‰ä¼šå„¿ï¼Œé‚£ä¸ç²¾ç¡®çš„ <code>cost</code> å€¼åº”è¯¥æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿæœ‰ä»€ä¹ˆè®¡ç®—å†…å­˜å ç”¨çš„è§„åˆ™å—ï¼Ÿæ¯”å¦‚æŒ‰æ•°é‡æ’åºæ¥è®¡ç®—ï¼Ÿâ€œéšä¾¿ççŒœå¯¼è‡´æ€§èƒ½å˜å·®â€ä¼¼ä¹ä¸ä¼šè®©äººæ»¡æ„â€¦â€¦</p><blockquote><p>å¦‚æœä½ æ²¡æœ‰æœ‰æ•ˆçš„å€¼ä¼ å…¥ï¼Œé‚£å°±ä¼ å…¥ 0ï¼Œæˆ–è€…ç”¨ setObject:forKey: æ–¹æ³•ï¼Œå®ƒä¸éœ€è¦ä¼ å…¥ <code>cost</code> å€¼ã€‚</p></blockquote><p>æ‡‚äº†ï¼šé™¤éä½ åœ¨ Apple å·¥ä½œå¹¶ä¸”è®¤è¯†å†™è¿™ä¸ªç±»çš„äººï¼Œå¦åˆ™ä¸è¦ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p>å¦å¤–ï¼Œå®ƒè¿˜æœ‰ä¸€å¥—ä½¿ç”¨ <code>evictsObjectsWithDiscardedContent</code> å’Œ <code>&lt;NSDiscardableContent></code> æ¥æ§åˆ¶å¯¹è±¡æ˜¯å¦ä¼šè¢«è‡ªåŠ¨ç§»é™¤çš„æœºåˆ¶ï¼Œä½†æ˜¯è¿™å¯èƒ½åªä¼šè®©ä½ ç¢°åˆ°æ›´å¤šçš„é—®é¢˜ã€‚</p><p>å°½ç®¡æœ‰ä¸Šé¢æåˆ°çš„è¿™äº›é—®é¢˜ï¼Œå¼€å‘è€…ä»¬è¿˜æ˜¯åº”è¯¥å¤šå¤šä½¿ç”¨ <code>NSCache</code>ã€‚ä½ é¡¹ç›®ä¸­ä»»ä½•ä½ ç§°ä¹‹ä¸ºç¼“å­˜å´ä¸æ˜¯ <code>NSCache</code> å¯¹è±¡çš„ä¸œè¥¿éƒ½åº”è¯¥è¢«æ¢æˆ <code>NSCache</code>ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ è¿™ä¹ˆåšäº†ï¼ŒåŠ¡å¿…è¦ç”¨ä½ ç†Ÿæ‚‰çš„é‚£å¥— <code>objectForKey:</code>ã€<code>setObject:forKey:</code>ã€<code>removeObjectForKey:</code> æ–¹æ³•ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2012-07-14 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Cocoa target=_blank>Cocoa</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>