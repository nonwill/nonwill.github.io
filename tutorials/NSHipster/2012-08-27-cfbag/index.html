<!doctype html><html><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=.5"><title>CFBag</title>
<link rel="shortcut icon" type=image/x-icon href=/media/shortcuticon.png><meta name=keywords content="CFBag,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><meta name=description content="CFBag,macOS,C++,Cocoa,Objective-C,Swift,NSHipster"><script>if(document.domain=="autoptr.pages.dev"){var url=window.location.href,url=url.replace(/autoptr+\.pages+\.dev/g,"www.autoptr.top");window.location.href=url}</script><script src=/jscss/ajax/libs/anchor-js/4.2.0/anchor.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){anchors.options={visible:"hover",placement:"left",icon:"ğŸŒœ"},anchors.add()})</script><link rel=stylesheet href=/css/main.css><link href=/jscss/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css rel=stylesheet><script src=/jscss/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><style type=text/css>body{background-color:#fbf6ec}</style><script>top.location!=self.location&&(top.location=self.location)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?746e6e6d14d22526bf274c834750df53",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script></head><body><script>window.addEventListener("resize",resizeThrottler,!1);var resizeTimeout;function resizeThrottler(){resizeTimeout||(resizeTimeout=setTimeout(function(){resizeTimeout=null,actualResizeHandler()},66))}actualResizeHandler();function actualResizeHandler(){/mobile/i.test(navigator.userAgent)||/android/i.test(navigator.userAgent)?document.body.classList.add("mobile"):document.body.classList.remove("mobile")}</script><a id=mysite-singlepage-top></a><div class=inner style=position:relative><div class=blog-post><h1 class=blog-title align=center><span class=btContent>CFBag</span><span class=btRight><span title="Author Â· ä½œè€…" class=author>Mattt</span> <span title="Translator Â· ç¿»è¯‘" class=author>Croath Liu</span> <a href=https://github.com/NSHipster/articles-zh-Hans style=color:#007cd5 title="Related or Quoted Post Â· å…³è”æˆ–è½¬è½½å¼•ç”¨çš„æ–‡ç« " target=_blank rel="nofollow noopener noreferrer">&#128681;</a><a href=/tutorials/NSHipster/ title="Back to Topics Â· å›ä¸»é¢˜é¡µ">&#127793;</a></span></h1><p>Objective-Cè¢«å¤¹åœ¨äº†ä¸¤ä¸ªä¸–ç•Œä¸­é—´ã€‚</p><p>åœ¨å…¶ä¸­ä¸€è¾¹çš„ä¸–ç•Œé‡Œï¼ŒObjective-Céµå¾ªç€ç»è¿‡æ·±æ€ç†Ÿè™‘çš„ã€å‘æ‰¬è‡ª[Smalltalk]çš„é¢å‘å¯¹è±¡å“²å­¦ç†å¿µï¼Œè¿™ç§ç†å¿µç»™æˆ‘ä»¬å¸¦æ¥äº†æ¶ˆæ¯ä¼ é€’å’Œå‚æ•°å‘½åæ³•ç­‰å¥½ç‚¹å­ã€‚å¦ä¸€è¾¹çš„ä¸–ç•Œé‡Œåˆ™é¿å…ä¸äº†æœ‰å¾ˆå¤š<a href=https://en.wikipedia.org/wiki/C_(programming_language)>C</a>çš„æ®‹ç•™æ€æƒ³å¸¦æ¥å¼ºå¤§çš„åŠ›é‡å’Œä¸€å¨æ··ä¹±ã€‚</p><p>è¶Šæ¥è¶Šå¤š<code>@</code>ç¬¦å·çš„ä½¿ç”¨è¯æ˜äº†è¿™ä¸ªä¸€è‡´æ€§å±æœºã€‚</p><p>Foundationå’ŒCore Foundationçš„å…³ç³»é‡Œä¹Ÿå¯ä»¥å‘ç°è¿™ç§ä¸€è‡´æ€§é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯é‚£ä¸€å †æ— ç¼è¿æ¥çš„ç±»ï¼š <code>NSArray</code> / <code>CFArray</code>, <code>NSDictionary</code> / <code>CFDictionary</code>, <code>NSSet</code> / <code>CFSet</code>ã€‚è¿™äº›ç±»å¯ä»¥é€šè¿‡Cå‡½æ•°å’ŒObjective-Cæ–¹æ³•ä¼ å…¥ä¼ å‡ºè€Œä¸éœ€è¦æ‰‹åŠ¨è½¬æ¢ã€‚è¿™æ˜¯æŠ½è±¡åŒ–è®¾è®¡çš„ç¼ºé™·ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿæ˜¯å†™åº”ç”¨æ—¶æœ€å®ç”¨çš„ä¼˜åŒ–æœ€éš¾ä»¥ä¼˜åŒ–éƒ¨åˆ†çš„ç»ä½³æ‰‹æ®µã€‚</p><p>ä½†æ˜¯è¿™ç§æ— ç¼è¿æ¥æ˜¯Foundationå’ŒCore Foundationä¹‹é—´é›†åˆç±»å‹è½¬æ¢çš„ä¸€ä¸ªä¾‹å¤–ï¼š</p><table><thead><tr><th>Foundation</th><th>Core Foundation</th><th>æ— ç¼è½¬æ¢</th></tr></thead><tbody><tr><td><tt>NSArray</tt><sup>*</sup></td><td><tt>CFArray</tt><sup>*</sup></td><td>âœ“</td></tr><tr><td><tt>NSCountedSet</tt></td><td><tt>CFBag</tt><sup>*</sup></td><td></td></tr><tr><td><em>N/A</em></td><td><tt>CFBinaryHeap</tt></td><td></td></tr><tr><td><em>N/A</em></td><td><tt>CFBitVector</tt><sup>*</sup></td><td></td></tr><tr><td><tt>NSDictionary</tt><sup>*</sup></td><td><tt>CFDictionary</tt><sup>*</sup></td><td>âœ“</td></tr><tr><td><tt>NSIndexSet</tt><sup>*</sup></td><td><em>N/A</em></td><td></td></tr><tr><td><tt>NSMapTable</tt></td><td><em>N/A</em></td><td></td></tr><tr><td><tt>NSOrderedSet</tt></td><td><em>N/A</em></td><td></td></tr><tr><td><tt>NSPointerArray</tt></td><td><em>N/A</em></td><td></td></tr><tr><td><tt>NSPointerFunctions</tt></td><td><em>N/A</em></td><td></td></tr><tr><td><tt>NSSet</tt><sup>*</sup></td><td><tt>CFSet</tt><sup>*</sup></td><td>âœ“</td></tr></tbody><tfoot><tr><td colspan=3><sup>*</sup> ä»£è¡¨åŒæ ·é€‚ç”¨äºç›¸åº”çš„mutableç±»å‹</td></tr></tfoot></table><p>çœ‹è¡¨æ ¼çš„ç¬¬äºŒè¡Œï¼Œ <code>NSCountedSet</code> å’Œ <code>CFBag</code>ã€‚æ³¨æ„ï¼šä¸åƒFoundationå’ŒCore Foundationä¸­çš„å…¶ä»–ç±»å‹ï¼Œä»–ä»¬ä¹‹é—´ä¸èƒ½æ— ç¼è½¬æ¢ã€‚ç›¸å…³æ–‡æ¡£ä¸­é™¤äº†æä¾›äº† <code>NSCountedSet</code> çš„ä¸€äº›ç®€ç•¥ä¿¡æ¯ï¼Œæ²¡æœ‰å…¶ä»–å®åœ¨çš„å†…å®¹èƒ½è§£é‡Šå­˜åœ¨è¿™æ ·çš„ç±»å‹è½¬æ¢æ–¹å¼ã€‚ã€‚æˆ‘çŒœæ˜¯å› ä¸º <code>NSCountedSet</code> æ²¡æœ‰å¯¹åº”çš„å¯å˜(mutable)ç±»å‹ï¼Œäºæ˜¯è¿™å°±æ‰“ç ´äº†ç±»ä¼¼ <code>NSArray</code> é‚£äº›æ”¯æŒæ— ç¼è½¬æ¢çš„å›ºæœ‰æ¨¡å¼ã€‚</p><h2 id=bagä¸€ç§æŠ½è±¡æ•°æ®ç±»å‹>Bagï¼Œä¸€ç§æŠ½è±¡æ•°æ®ç±»å‹</h2><p>åœ¨è®¡ç®—æœºç§‘å­¦é¢†åŸŸ<a href=https://en.wikipedia.org/wiki/Collection_(abstract_data_type)>é›†åˆæ•°æ®ç±»å‹çš„æ®¿å ‚</a>ä¸­ï¼Œbagæ²¡æœ‰æ•°ç»„ã€é›†åˆã€è”åˆæ•°ç»„ã€æ ‘ã€å›¾ã€ä¼˜å…ˆé˜Ÿåˆ—é‚£ä¹ˆå æœ‰ä¸€å¸­ä¹‹åœ°ã€‚</p><p>å…¶å®bagæœ¬èº«å°±å¾ˆæ™¦æ¶©ï¼Œä½ å¯èƒ½ä»æ²¡å¬è¿‡è¿™ä¸œè¥¿ã€‚</p><p>Bagï¼Œæˆ–è€…å«åš<a href=https://en.wikipedia.org/wiki/Multiset>multiset</a>ï¼Œæ˜¯setçš„ä¸€ç§å˜ä½“ï¼Œä¸åŒçš„æ˜¯bagé‡ŒåŒä¸€æ•°æ®å¯ä»¥å‡ºç°ä¸æ­¢ä¸€æ¬¡ã€‚é›†åˆä¸­æ¯ä¸€ä¸ªå”¯ä¸€å…ƒç´ ä¼šæœ‰ä¸€ä¸ªåˆè®¡æ•°å­—ä¸å…¶ç»‘å®šã€‚ç±»ä¼¼setä¸€æ ·ï¼Œbagä¹Ÿæ˜¯é¡ºåºä¸æ•æ„Ÿçš„ã€‚</p><p>ç”¨bagçš„åœºæ™¯æœ‰&mldr;å’³å’³&mldr;å¾ˆå°‘ï¼Œä½†æœ‰å¦‚æœå®ƒå‡ºç°ä½ è‚¯å®šèƒ½æ„Ÿè§‰åˆ°é‚£å°±æ˜¯bagã€‚å¤§é€‰ä¸­ç»Ÿè®¡ç¥¨æ•°ï¼Ÿæ¨¡æ‹Ÿå®¶åº­ä½œä¸šä¸­çš„æ¦‚ç‡åˆ†å¸ƒï¼Ÿå®ç°ä¸€ä¸ªYahtzeeéª°å­æ¸¸æˆï¼ŸBagéƒ½æ˜¯ä½ çš„æ–°é€‰æ‹©ï¼</p><h2 id=ä½¿ç”¨cfmutablebag>ä½¿ç”¨<code>CFMutableBag</code></h2><p><code>CFBag</code> å’Œå®ƒçš„å¯å˜ç±»å‹åŒç±» <code>CFMutableBag</code> ä½œä¸ºbagç±»å‹çš„å…·ä½“å®ç°ï¼Œéƒ½æ˜¯éå¸¸çµæ´»çš„ã€‚</p><p>è™½ç„¶å®ƒä»¬æ²¡æœ‰åƒ <code>NSCountedSet</code> é‚£æ ·æ–¹ä¾¿åœ°é¢å‘å¯¹è±¡åŒ–ï¼Œä½†å®ƒå¯ä»¥è¿›è¡Œçš„è‡ªå®šä¹‰è¡Œä¸ºå´æ˜¯å¤šç§å¤šæ ·çš„ã€‚ä½ å¯ä»¥ç”¨å¸¦æœ‰è®¸å¤šå›è°ƒçš„åˆå§‹åŒ–å‡½æ•°æ¥å»ºç«‹ä¸€ä¸ª <code>CFBag</code> ï¼Œè¿™äº›å›è°ƒå‡½æ•°å®šä¹‰åœ¨ <code>CFBagCallBacks</code> ç»“æ„ä¸­ï¼Œè¯¥ç»“æ„è¯¦ç»†æè¿°äº†ä¸€ä¸ªå€¼è¢«æ’å…¥ã€åˆ é™¤ã€æ¯”è¾ƒçš„æ–¹æ³•ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>struct</span> CFBagCallBacks {
</span></span><span style=display:flex><span>   CFIndex version;
</span></span><span style=display:flex><span>   CFBagRetainCallBack <span style=color:#66d9ef>retain</span>;
</span></span><span style=display:flex><span>   CFBagReleaseCallBack <span style=color:#66d9ef>release</span>;
</span></span><span style=display:flex><span>   CFBagCopyDescriptionCallBack copyDescription;
</span></span><span style=display:flex><span>   CFBagEqualCallBack equal;
</span></span><span style=display:flex><span>   CFBagHashCallBack hash;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> CFBagCallBacks CFBagCallBacks;
</span></span></code></pre></div><ul><li><code>retain</code>: å½“ä¸€ä¸ªå€¼è¢«æ·»åŠ åˆ°é›†åˆé‡Œæ—¶ç”¨äºretainå®ƒçš„å›è°ƒ</li><li><code>release</code>: å½“ä¸€ä¸ªå€¼è¢«ä»é›†åˆé‡Œåˆ é™¤æ—¶ç”¨äºreleaseå®ƒçš„å›è°ƒ</li><li><code>copyDescription</code>: ç”¨äºé›†åˆä¸­æ¯ä¸ªå€¼å»ºç«‹ä¸€ä¸ªstringç±»å‹çš„descriptionçš„å›è°ƒ</li><li><code>equal</code>: ç”¨äºæ¯”è¾ƒé›†åˆä¸­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰çš„å›è°ƒ</li><li><code>hash</code>: é›†åˆä¸­ç”¨äºè®¡ç®—å€¼çš„Hashçš„å›è°ƒ</li></ul><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨åšä¸€ä¸ªæŠ•ç¥¨ç»Ÿè®¡åº”ç”¨ï¼Œä½ å¯ä»¥åˆ¶å®šä¸€ä¸ªç”¨äº <code>retain</code> å›è°ƒå‡½æ•°æ¥ä¿è¯ä¸åŒå¤§å°å†™å’Œé”™è¯¯æ‹¼å†™çš„åå­—èƒ½å¤Ÿå½’ç±»åˆ°æ­£ç¡®çš„å€™é€‰äººï¼›ä¹Ÿå¯ä»¥ç”¨ <code>equal</code> å›è°ƒå‡½æ•°æ¥ä¿è¯å½“æ‰€æœ‰é€‰ç¥¨éƒ½ç»Ÿè®¡å®Œæ—¶èƒ½å¤Ÿè®¡ç®—å‡ºç¥¨æœ€å¤šçš„å€™é€‰äººã€‚</p><p><code>CFMutableBag</code> ä¹Ÿæœ‰ <code>CFBagApplyFunction</code>ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥æ”¹å˜é›†åˆä¸­çš„å€¼ï¼Œæ¯”å¦‚è¯´ç†é¡ºé€‰ä¸¾æ•°é‡ä¹‹ç±»çš„ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ è¦å‡†å¤‡æä¸€ä¸ªé€‰ä¸¾ï¼Œ <code>CFBag</code> æ˜¯ä½ çš„æœ€ä½³é€‰æ‹©ã€‚</p><hr><p>ä¸¥è‚ƒåœ°è®²ï¼Œ <code>CFBag</code> åœ¨å®ƒæ“…é•¿çš„é¢†åŸŸå†…ç¡®å®å¥½ç”¨ï¼Œå®ƒæ—¶åˆ»æé†’ç€ä½ è¿™æ˜¯æ ‡å‡†æ¡†æ¶å’Œæ ‡å‡†åº“ä¸­çš„ä¸€å—éšè—çš„å®çŸ³ï¼Œè€Œå‘è§‰éšè—çš„å®è—ï¼Œå°±æ˜¯æˆä¸ºä¸€ä¸ªNSHipsterçš„æ ¸å¿ƒã€‚</p><p>åŒæ ·çš„ï¼Œ<code>CFBinaryHeap</code> å‘¢ï¼Ÿ <code>NSPointerFunctions</code> å‘¢ï¼Ÿ <code>NSMapTable</code> å‘¢ï¼Ÿåˆ«æ€¥ï¼Œä»¥åæˆ‘ä»¬éƒ½ä¼šè°ˆåˆ°çš„ã€‚</p><hr><p>é™¤é<a href=https://nshipster.cn/ target=_blank>å¦æœ‰å£°æ˜</a>ï¼Œæœ¬æ–‡é‡‡ç”¨çŸ¥è¯†å…±äº«ã€Œ<a href=https://creativecommons.org/licenses/by-nc/3.0/cn/ target=_blank>ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 3.0 ä¸­å›½å¤§é™†</a>ã€è®¸å¯åè®®æˆæƒã€‚</p><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-8922574795542092 data-ad-slot=2802455178 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><footer><p style="margin:0 -3px"><span style="float:left;margin:0 -3px"><a href=#mysite-singlepage-top title="Back to Top Â· å›é¡¶éƒ¨" rel=nofollow>&#127772;2012-08-27 </a>&copy;</span>
<span style="float:right;margin:0 -3px"><a href=https://autoptr.top/license/ title="Copyright &copy; All rights reserved" target=_blank rel=nofollow>&copy; 2026 Mattt ç‰ˆæƒæ‰€æœ‰</a><a href=https://autoptr.top/ title="Back to Home Â· å›é¦–é¡µ">&#127771;</a></span></p><hr><hr><p style="margin:3px 5px"><ul class=tags><span>æ ‡ç­¾:</span><li><a class=link href=https://autoptr.top/tags/C++ target=_blank>C++</a></li><li><a class=link href=https://autoptr.top/tags/nshipster target=_blank>nshipster</a></li><span>&nbsp;&nbsp;</span>
<span>åˆ†ç±»:</span><li><a class=link href=https://autoptr.top/categories/Cocoa target=_blank>Cocoa</a></li><li><a class=link href=https://autoptr.top/categories/macOS target=_blank>macOS</a></li><li><a class=link href=https://autoptr.top/categories/CC++ target=_blank>CC++</a></li></ul><p style=margin-bottom:2em></p></p></footer></div><script src=/jscss/ajax/libs/jquery/3.3.1/jquery.slim.min.js></script><script src=/jscss/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-37ZP0S1L3D"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-37ZP0S1L3D")</script><script src=/jscss/ajax/libs/medium-zoom/1.0.4/medium-zoom.min.js></script><script>const zoom=mediumZoom();zoom.attach("p img")</script></body></html>